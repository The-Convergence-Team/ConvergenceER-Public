// ==EMEVD==
// @docs    er-common.emedf.json
// @compress    DCX_KRAK
// @game    Sekiro
// @string    "N:\\GR\\data\\Param\\event\\common_func.emevd\u0000N:\\GR\\data\\Param\\event\\common_macro.emevd\u0000\u0000\u0000\u0000\u0000\u0000"
// @linked    [0,82]
// @version    3.4.2
// ==/EMEVD==

$Event(0, Default, function() {
    RegisterBonfire(16000002, 16001952, 0, 0, 0, 5);
    RegisterBonfire(16000003, 16001953, 0, 0, 0, 5);
    RegisterBonfire(16000004, 16001954, 0, 0, 0, 5);
    RegisterBonfire(16000005, 16001960, 0, 0, 0, 5);
    RegisterBonfire(16000007, 16001964, 0, 0, 0, 5);
    RegisterBonfire(16000008, 16001965, 0, 0, 0, 5);
    RegisterBonfire(16000009, 16001959, 0, 0, 0, 5);
    InitializeCommonEvent(0, 9005810, 16000800, 16000000, 16000950, 16001950, 1101004800);
    InitializeCommonEvent(1, 9005810, 16000850, 16000001, 16000951, 16001951, 1090519040);
    InitializeCommonEvent(2, 9005810, 16000860, 16000006, 16000962, 16001962, 1090519040);
    InitializeEvent(0, 16002810, 0);
    InitializeEvent(0, 16002800, 0);
    InitializeEvent(0, 16002811, 0);
    InitializeEvent(0, 16002812, 0);
    InitializeEvent(0, 16002813, 0);
    InitializeEvent(0, 16002814, 0);
    InitializeEvent(0, 16002822, 0);
    InitializeEvent(0, 16002824, 0);
    InitializeEvent(0, 16002826, 0);
    InitializeEvent(0, 16002830, 0);
    InitializeEvent(0, 16002832, 0);
    InitializeEvent(0, 16002836, 0);
    InitializeEvent(0, 16002838, 0);
    InitializeEvent(0, 16002840, 0);
    InitializeEvent(0, 16002842, 16000800);
    InitializeEvent(1, 16002842, 16000801);
    InitializeEvent(0, 16002849, 0);
    InitializeEvent(0, 16002855, 0);
    InitializeEvent(0, 16002850, 0);
    InitializeEvent(0, 16002899, 0);
    InitializeEvent(0, 16002865, 0);
    InitializeEvent(0, 16002860, 0);
    InitializeEvent(0, 16002889, 0);
    InitializeEvent(0, 16002695, 0);
    InitializeEvent(0, 16002690, 16002696, 16001690, 16001692);
    InitializeEvent(0, 16002691, 16001690, 16001692, 16002690);
    InitializeEvent(0, 16002620, 16000622, 16001622);
    InitializeEvent(1, 16002620, 16000624, 16001624);
    InitializeEvent(0, 16002500, 0);
    InitializeEvent(0, 16002650, 0);
    InitializeCommonEvent(0, 90005515, 16008544, 16001544);
    InitializeCommonEvent(0, 90005515, 16008546, 16001546);
    InitializeCommonEvent(0, 90005515, 16008548, 16001548);
    //Prison Town Church Door "Does Not Open From This Side" Message Common Event Initialize
    //InitializeCommonEvent(0, 90005515, 16008542, 16001542);
    InitializeCommonEvent(0, 90005515, 16008552, 16001552);
    InitializeCommonEvent(0, 90005515, 16008556, 16001556);
    InitializeCommonEvent(0, 90005515, 16008554, 16001554);
    InitializeCommonEvent(0, 90005510, 16000552, 16001552, 16003552, 1277018, 208134, 0);
    InitializeCommonEvent(0, 90005510, 16000564, 16001564, 16003564, 1277018, 208134, 0);
    InitializeCommonEvent(0, 90005510, 16000560, 16001560, 16003560, 1277018, 208134, 0);
    InitializeCommonEvent(0, 90005510, 16000562, 16001562, 16003562, 1277018, 208134, 0);
    InitializeEvent(0, 16002580, 0);
    InitializeEvent(0, 16002510, 0);
    InitializeCommonEvent(0, 90005501, 16000510, 16001510, 0, 16001510, 16001511, 16001512, 16000511);
    InitializeCommonEvent(0, 90005501, 16000520, 16001520, 0, 16001520, 16001521, 16001522, 16000521);
    InitializeCommonEvent(0, 90005504, 16000525, 16001525, 0, 16001525, 16000526);
    InitializeCommonEvent(0, 90005504, 16000530, 16001530, 1, 16001530, 16000531);
    InitializeEvent(0, 16002640, 0);
    InitializeEvent(0, 16002570, 16001570, 16, 16002570, 0, 16002574, 16002572, 16002573);
    InitializeEvent(0, 16002579, 0);
    InitializeEvent(0, 16002689, 0);
    InitializeEvent(0, 16002670, 0);
    InitializeCommonEvent(0, 900005610, 16001670, 100, 800, 0);
    InitializeCommonEvent(0, 900005610, 16001671, 100, 800, 0);
    InitializeCommonEvent(0, 90005502, 16000514, 16001512, 16002511);
    InitializeEvent(0, 16002590, 0);
    InitializeCommonEvent(0, 90005694, 16001651, 16001650, 201, 0, 200400, 1061158912, 0, 1065353216);
    InitializeEvent(0, 16002505, 0);
    InitializeCommonEvent(0, 90005620, 16000575, 16001575, 16001576, 0, 16002575, 16002576, 16002577);
    InitializeCommonEvent(0, 90005621, 16000575, 16001578);
    InitializeCommonEvent(0, 90005620, 16000565, 16001565, 16001566, 16001567, 16002565, 16002566, 16002567);
    InitializeCommonEvent(0, 90005621, 16000565, 16001568);
    InitializeCommonEvent(0, 90005790, 0, 16000180, 16002181, 16002182, 16000180, 23, 16002180, 16002181, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005791, 16000180, 16002181, 16002182, 16000180);
    InitializeCommonEvent(0, 90005792, 16000180, 16002181, 16002182, 16000180, 16000940, 0);
    InitializeEvent(0, 16002185, 16000180, 16002181, 16002182, 16000180, 16002180, 16002182);
    InitializeCommonEvent(0, 90005702, 16000701, 3103, 3100, 3104);
    InitializeEvent(0, 16003700, 16000700, 16002700, 16000740);
    InitializeEvent(0, 16003701, 16000701, 16000760, 16001709);
    InitializeEvent(0, 16003702, 400073);
    InitializeEvent(0, 16003703, 16001701, 16001706, 16001700);
    InitializeEvent(0, 16003704, 7602, 7603, 7604);
    InitializeEvent(0, 16003707, 16000700, 16009270);
    InitializeEvent(0, 16003705, 16000741, 16000701);
    InitializeEvent(0, 16003706, 16000741, 16000701);
    InitializeEvent(0, 16003708, 0);
    InitializeCommonEvent(0, 90005750, 16001702, 4350, 100730, 400073, 400073, 16009208, 6101);
    InitializeCommonEvent(0, 90005750, 16001703, 4350, 100740, 400074, 400074, 16009216, 6101);
    InitializeCommonEvent(0, 90005750, 16001704, 4350, 100750, 400075, 400075, 16009217, 6101);
    InitializeCommonEvent(0, 90005750, 16001708, 4350, 100720, 400072, 400072, 16009270, 6101);
    InitializeCommonEvent(0, 90005750, 16001709, 4350, 100710, 400071, 400071, 16009266, 6101);
    InitializeCommonEvent(0, 90005775, 80110000, 400290, -1082130432);
    InitializeCommonEvent(0, 90005775, 80392000, 400180, -1082130432);
    InitializeCommonEvent(0, 90005775, 81423900, 400073, -1082130432);
    InitializeCommonEvent(0, 90005775, 83395300, 400074, -1082130432);
    InitializeCommonEvent(0, 90005775, 85505600, 400075, -1082130432);
    InitializeEvent(0, 16003710, 16000710);
    InitializeEvent(0, 16003712, 0);
    InitializeCommonEvent(0, 90005702, 16000722, 3423, 3420, 3424);
    InitializeEvent(0, 16003720, 16000720, 16000721);
    InitializeEvent(0, 16003722, 16000722, 16000723);
    InitializeEvent(0, 16003721, 16009208);
    InitializeEvent(0, 16003723, 16000722, 16000723);
    InitializeEvent(0, 16003724, 0);
    InitializeEvent(0, 16003725, 0);
    InitializeEvent(0, 16003726, 0);
    InitializeEvent(0, 16003727, 0);
    InitializeCommonEvent(0, 90005750, 16001720, 4350, 100910, 400091, 400091, 16009337, 0);
    InitializeCommonEvent(0, 90005750, 16001721, 4350, 100911, 400091, 400091, 16009338, 0);
    InitializeEvent(0, 16003730, 16000730);
    InitializeEvent(0, 16003731, 16009417, 16002731, 16009400);
    InitializeEvent(0, 16003740, 16000750, 16001705, 16002710);
    InitializeEvent(0, 16003742, 16000751, 16001711, 16001705);
    InitializeEvent(0, 16003741, 16009450);
    InitializeEvent(0, 16003743, 0);
    InitializeCommonEvent(0, 90005750, 16001712, 4350, 102910, 400291, 400291, 16009463, 0);
    InitializeEvent(0, 16003750, 16000801, 16000800, 9122, 16002805, 1128464384);
    InitializeEvent(0, 16003760, 16000770);
    InitializeEvent(0, 16003761, 16000770);
    InitializeEvent(0, 16003762, 16001707, 4110, 2, 60802, 60802, 9122, 0);
    InitializeEvent(0, 16003763, 0);
    InitializeEvent(0, 16003764, 0);
    InitializeEvent(0, 16003765, 0);
    //itializeCommonEvent(0, 90005605, 16000780, 60, 34, 54, 1, 1034542781, 60, 0, 30040, 0, 0);
    InitializeEvent(0, 16003770, 0);
    InitializeEvent(0, 16003780, 0);
    InitializeCommonEvent(0, 90005200, 16002000, 30003, 20003, 16002103, 0, 0, 0, 0, 0);
    InitializeCommonEvent(1, 90005200, 16002001, 30003, 20003, 16002101, 0, 0, 0, 0, 0);
    InitializeCommonEvent(2, 90005200, 16002002, 30003, 20003, 16002102, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 98005302, 16002010); // Forced Night in new cave
    InitializeCommonEvent(0, 90005690, 16002913); // falling protection
    InitializeCommonEvent(0, 90005691, 16002913);
    InitializeCommonEvent(0, 90005690, 16002577);
    InitializeCommonEvent(0, 90005691, 16002577);
    InitializeEvent(0, 16001730, 0); // Disabling cave assets when outside of it.
    InitializeEvent(0, 16001731, 0); // fall teleport
    InitializeCommonEvent(0, 90005501, 16000513, 16000516, 0, 16001515, 16001517, 16001516, 16000517); // Elevator
    InitializeEvent(0, 16001732, 0);
    InitializeCommonEvent(0, 90005525, 16002015, 16002115); // illusion wall
    InitializeEvent(0, 16001733, 0); //dropdown boi
});

$Event(50, Default, function() {
    SetCharacterBackreadState(16000700, true);
    SetCharacterBackreadState(16000701, true);
    SetCharacterBackreadState(16000710, true);
    SetCharacterBackreadState(16000720, true);
    SetCharacterBackreadState(16000721, true);
    SetCharacterBackreadState(16000722, true);
    SetCharacterBackreadState(16000723, true);
    SetCharacterBackreadState(16000730, true);
    SetCharacterBackreadState(16000740, true);
    SetCharacterBackreadState(16000741, true);
    SetCharacterBackreadState(16000750, true);
    SetCharacterBackreadState(16000751, true);
    SetCharacterBackreadState(16000760, true);
    SetCharacterBackreadState(16000770, true);
    EnableAssetInvunerability(16001700);
    EnableAssetInvunerability(16001701);
    EnableAssetInvunerability(16001705);
    EnableAssetInvunerability(16001706);
    InitializeEvent(0, 16000519, 0);
    InitializeCommonEvent(0, 90005250, 16000345, 16002345, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000346, 16002345, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000348, 16002345, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000355, 16002355, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000344, 16002344, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000343, 16002343, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000349, 16002343, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000350, 16002343, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000354, 16002343, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000520, 1090519040, 0, -1);
    InitializeCommonEvent(0, 16002310, 16000316, 1099956224, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000311, 1103626240, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000224, 1090519040, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000225, 16002225, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000226, 16002225, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000212, 16002225, 1090519040, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000227, 16002227, 1092616192, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000216, 1095761920, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000210, 1101004800, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000219, 1090519040, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000220, 1090519040, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000410, 16002410, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000411, 16002410, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000460, 16002460, 0, 3012);
    InitializeCommonEvent(0, 90005250, 16000500, 16002500, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000462, 16002462, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000203, 16002203, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000204, 16002203, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000205, 16002203, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000206, 16002203, 0, -1);
    InitializeCommonEvent(0, 90005250, 16000207, 16002203, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000322, 1101004800, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000314, 16002314, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000270, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000271, 1086324736, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000272, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000273, 1086324736, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000274, 1077936128, 0, 3015);
    InitializeCommonEvent(0, 90005251, 16000275, 1086324736, 1065353216, -1);
    InitializeCommonEvent(0, 90005251, 16000276, 1077936128, 0, 3015);
    InitializeCommonEvent(0, 90005211, 16000277, 30001, 20020, 16002277, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005261, 16000278, 16002278, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000279, 16002278, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000280, 16002278, 1077936128, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000281, 16002278, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000282, 16002278, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000283, 16002278, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000235, 1096810496, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000238, 1097859072, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000236, 1094713344, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000237, 1084227584, 0, 3002);
    InitializeCommonEvent(0, 90005251, 16000240, 1092616192, 0, -1);
    InitializeCommonEvent(0, 90005211, 16000510, 30001, 20001, 16002510, 1101004800, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005300, 16000512, 16000510, 16002000, 0, 0);
    InitializeCommonEvent(0, 90005261, 16000461, 16002461, 1092616192, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000338, 16002338, 1092616192, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000328, 16002339, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005261, 16000339, 16002339, 1077936128, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000440, 1077936128, 0, -1);
    InitializeCommonEvent(0, 90005251, 16000441, 1077936128, 0, -1);
    InitializeCommonEvent(0, 90005201, 16000443, 30011, 20, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 16000445, 30011, 20, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005211, 16000446, 30011, 20, 16002446, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005261, 16000327, 16002327, 1077936128, 0, 3007);
    InitializeCommonEvent(0, 90005201, 16000450, 30011, 20, 1065353216, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 16000451, 30011, 20, 1077936128, 0, 0, 0, 0, 0);
    InitializeEvent(0, 16009000, 0);
    InitializeEvent(0, 16002587, 0);
    InitializeCommonEvent(0, 90005300, 16000420, 16000420, 40590, 0, 0);
    InitializeCommonEvent(0, 90005300, 16000421, 16000421, 40592, 0, 0);
    
    InitializeCommonEvent(0, 90005250, 16003241, 16000239, 0, -1); //Volcanist NPC trigger box
    InitializeCommonEvent(0, 90005300, 16000245, 16003241, 105700, 0, 0); // Volcanist NPC reward
});

$Event(16002185, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4) {
    EndIf(EventFlag(X0_4));
    WaitFor(EventFlag(X0_4) || (EventFlag(X4_4) && !InArea(10000, X20_4)));
    EndIf(EventFlag(X0_4));
    SendNPCSummonHome(X0_4);
    EndEvent();
    flag = !EventFlag(X8_4) || !EventFlag(X12_4) || !EventFlag(X16_4);
});

$Event(16002310, Restart, function(X0_4, X4_4, X8_4, X12_4) {
    EndIf(SpecialStandbyEndedFlag(X0_4));
    DisableCharacterAI(X0_4);
    chrSp = (CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
        || CharacterType(10000, TargetType.Alive)
        || CharacterType(10000, TargetType.GrayPhantom)
        || CharacterType(10000, TargetType.WhitePhantom);
    sp = CharacterHasSpEffect(X0_4, 481)
        && !CharacterHasSpEffect(X0_4, 90100)
        && !CharacterHasSpEffect(X0_4, 90110)
        && !CharacterHasSpEffect(X0_4, 90160);
    sp2 = CharacterHasSpEffect(X0_4, 482)
        && !CharacterHasSpEffect(X0_4, 90100)
        && !CharacterHasSpEffect(X0_4, 90120)
        && !CharacterHasSpEffect(X0_4, 90160)
        && !CharacterHasSpEffect(X0_4, 90162);
    sp3 = CharacterHasSpEffect(X0_4, 483)
        && !CharacterHasSpEffect(X0_4, 90100)
        && !CharacterHasSpEffect(X0_4, 90140)
        && !CharacterHasSpEffect(X0_4, 90160)
        && !CharacterHasSpEffect(X0_4, 90161);
    sp4 = CharacterHasSpEffect(X0_4, 484)
        && !CharacterHasSpEffect(X0_4, 90100)
        && !CharacterHasSpEffect(X0_4, 90130)
        && !CharacterHasSpEffect(X0_4, 90161)
        && !CharacterHasSpEffect(X0_4, 90162);
    sp5 = CharacterHasSpEffect(X0_4, 487)
        && !CharacterHasSpEffect(X0_4, 90100)
        && !CharacterHasSpEffect(X0_4, 90150)
        && !CharacterHasSpEffect(X0_4, 90160);
    areaChrSp = EntityInRadiusOfEntity(10000, X0_4, X4_4, 1) && chrSp;
    WaitFor(
        HasDamageType(X0_4, 0, DamageType.Unspecified)
            || CharacterHasStateInfo(X0_4, 436)
            || CharacterHasStateInfo(X0_4, 2)
            || CharacterHasStateInfo(X0_4, 5)
            || CharacterHasStateInfo(X0_4, 6)
            || CharacterHasStateInfo(X0_4, 260)
            || areaChrSp
            || sp
            || sp2
            || sp3
            || sp4
            || sp5);
    SetNetworkconnectedThisEventSlot(ON);
    SetSpecialStandbyEndedFlag(X0_4, ON);
    if (areaChrSp.Passed) {
        WaitFixedTimeSeconds(X8_4);
        if (Signed(X12_4) != -1) {
            ForceAnimationPlayback(X0_4, X12_4, true, false, false);
        }
    }
L1:
    RotateCharacter(X0_4, 16002310, -1, true);
    EnableCharacterAI(X0_4);
});

$Event(16002500, Default, function() {
    if (EventFlag(16000500)) {
        ReproduceAssetAnimation(16001500, 20);
        ReproduceAssetAnimation(16001501, 1);
        DisableObjAct(16001501, -1);
        DisableAsset(16001660);
        EndEvent();
    }
L0:
    if (!(HasMultiplayerState(MultiplayerState.MultiplayerPending)
        && !HasMultiplayerState(MultiplayerState.Multiplayer))) {
        EnableObjAct(16001501, 277081);
        WaitFor(
            PlayerIsInOwnWorld()
                && (ObjActEventFlag(16003501)
                    || (HasMultiplayerState(MultiplayerState.MultiplayerPending)
                        && !HasMultiplayerState(MultiplayerState.Multiplayer))));
        if (!(HasMultiplayerState(MultiplayerState.MultiplayerPending)
            && !HasMultiplayerState(MultiplayerState.Multiplayer))) {
            SetNetworkconnectedEventFlagID(16000500, ON);
            SetNetworkconnectedEventFlagID(9021, ON);
            PlayCutsceneToPlayer(16000000, CutscenePlayMode.Skippable, 10000);
            WaitFixedTimeRealFrames(1);
            ReproduceAssetAnimation(16001500, 20);
            DisableAsset(16001660);
            EndEvent();
        }
    }
L1:
    DisableObjAct(16001501, 277081);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002505, Default, function() {
    DisableAsset(16001505);
});

$Event(16002510, Default, function() {
    InitializeCommonEvent(0, 90005500, 16000510, 16001510, 0, 16001510, 16001511, 16003511, 16001512, 16003512, 16002511, 16002512, 16000511, 16002512, 16000514);
    InitializeCommonEvent(0, 90005500, 16000520, 16001520, 0, 16001520, 16001521, 16003521, 16001522, 16003522, 16002521, 16002522, 16000521, 16002522, 16000850);
    InitializeCommonEvent(0, 90005503, 16000525, 16001525, 0, 16001525, 16002526, 16002527, 16002528, 16002529, 16000526, 16002527, 0);
    InitializeCommonEvent(0, 90005503, 16000530, 16001530, 1, 16001530, 16002531, 16002532, 16002533, 16002534, 16000531, 16002532, 0);
});

$Event(16000519, Default, function() {
    EndIf(ThisEventSlot());
    SetEventFlagID(16000510, ON);
    SetEventFlagID(16000515, ON);
    SetEventFlagID(16000520, ON);
    SetEventFlagID(16000525, ON);
});

$Event(16002650, Restart, function() {
    EndIf(!EventFlag(16000540));
    EndIf(!PlayerIsInOwnWorld());
    SetEventFlagID(9080, ON);
    SetEventFlagID(16000540, OFF);
});

$Event(16002570, Restart, function(X0_4, X4_1, X5_1, X6_1, X7_1, X8_4, X12_4, X16_4, X20_4, X24_4) {
    EndIf(!PlayerIsInOwnWorld());
    SetEventFlagID(X20_4, OFF);
    SetEventFlagID(X24_4, OFF);
    DeleteAssetfollowingSFX(X0_4, true);
    CreateAssetfollowingSFX(X0_4, 200, 806870);
    onlineAct = PlayerIsInOwnWorld()
        && !HasMultiplayerState(MultiplayerState.MultiplayerPending)
        && ActionButtonInArea(9140, X0_4);
    online = HasMultiplayerState(MultiplayerState.MultiplayerPending)
        && !HasMultiplayerState(MultiplayerState.Multiplayer);
    onlineAct2 = PlayerIsInOwnWorld()
        && HasMultiplayerState(MultiplayerState.MultiplayerPending)
        && HasMultiplayerState(MultiplayerState.Multiplayer)
        && ActionButtonInArea(9140, X0_4);
    WaitFor(
        onlineAct
            || online
            || onlineAct2
            || (HasMultiplayerState(MultiplayerState.InvasionPending)
                || HasMultiplayerState(MultiplayerState.Invasion)));
    if (!onlineAct.Passed) {
        if (!onlineAct2.Passed) {
            DeleteAssetfollowingSFX(X0_4, true);
            WaitFixedTimeSeconds(1);
            RestartEvent();
        }
    }
L3:
    //DisplayGenericDialogAndSetEventFlags(4300, PromptType.YESNO, NumberofOptions.TwoButtons, X0_4, 3, X20_4, X24_4, X24_4);
    //if (!EventFlag(X20_4)) {
        //    WaitFixedTimeSeconds(1);
        //RestartEvent();
    //}
L6:
    if (!((HasMultiplayerState(MultiplayerState.MultiplayerPending)
        && HasMultiplayerState(MultiplayerState.Multiplayer))
        || (!HasMultiplayerState(MultiplayerState.MultiplayerPending)
            && !HasMultiplayerState(MultiplayerState.Multiplayer)))) {
        RestartEvent();
    }
    RestartIf(
        HasMultiplayerState(MultiplayerState.InvasionPending)
            || HasMultiplayerState(MultiplayerState.Invasion));
    RotateCharacter(10000, X0_4, -1, true);
    ForceAnimationPlayback(10000, 60490, false, false, false);
    WaitFixedTimeSeconds(3);
    WarpCharacterAndCopyFloorWithFadeout(10000, TargetEntityType.Area, X8_4, 10, 10000, false, true);
    SetNetworkconnectedEventFlagID(16002578, ON);
    RestartEvent();
    Goto(S0);
    SetEventFlagID(X16_4, OFF);
S0:
    Goto(S1);
    WarpPlayer(X4_1, X5_1, X6_1, X7_1, X8_4, X12_4);
S1:
    NoOp();
});

$Event(16002579, Restart, function() {
    DisableNetworkSync();
    EndIf(PlayerIsInOwnWorld());
    WaitFor(EventFlag(16002578));
    WarpCharacterAndCopyFloorWithFadeout(20000, TargetEntityType.Area, 16002575, 10, 20000, false, true);
    EndEvent();
});

$Event(16002580, Restart, function() {
    RegisterLadder(16000580, 16000581, 16001580);
    RegisterLadder(16000582, 16000583, 16001582);
    RegisterLadder(16000590, 16000591, 16001590);
    RegisterLadder(16000592, 16000593, 16001592);
    RegisterLadder(16000594, 16000595, 16001594);
    RegisterLadder(16000596, 16000597, 16001596)
    RegisterLadder(16000598, 16000599, 16001598)
});

$Event(16002590, Restart, function() {
    EndIf(EventFlag(16000850));
    WaitFixedTimeSeconds(2);
    //Fix for Elevator issue change
    DisableObjAct(16001522, -1);
});

$Event(16002620, Restart, function(X0_4, X4_4) {
    if (!EventFlag(X0_4)) {
        WaitFor(
            PlayerIsInOwnWorld()
                && (HasDamageType(X4_4, 20000, DamageType.Unspecified)
                    || EntityInRadiusOfEntity(X4_4, 10000, 1, 1)));
        SetNetworkconnectedEventFlagID(X0_4, ON);
        ForceAnimationPlayback(X4_4, 1, false, true, false);
    }
L0:
    DisableAsset(X4_4);
});

$Event(16002640, Restart, function() {
    if (EventFlag(16000640)) {
        DisableAsset(16001640);
        EndEvent();
    }
L0:
    WaitFor(InArea(10000, 16002640));
    RequestAssetDestruction(16001640, 1);
    SetEventFlagID(16000640, ON);
});

$Event(16002670, Restart, function() {
    DisableNetworkSync();
    WaitFor(InArea(20000, 16002670));
    SetSpEffect(20000, 9621);
    WaitFixedTimeSeconds(0.1);
    WaitFor(!InArea(20000, 16002670));
    WaitFixedTimeSeconds(0.1);
    ClearSpEffect(20000, 9621);
    RestartEvent();
});

$Event(16002689, Restart, function() {
    DisableNetworkSync();
    if (!ThisEventSlot()) {
        DeleteMapSFX(16003680, false);
    }
    WaitFor(
        PlayerInMap(16, 0, -1, -1)
            && InArea(10000, 16002680)
            && !InArea(10000, 16002681)
            && !InArea(10000, 16002682));
    SpawnMapSFX(16003680);
    WaitFixedTimeSeconds(1);
    WaitFor(
        !PlayerInMap(16, 0, -1, -1)
            || !InArea(10000, 16002680)
            || InArea(10000, 16002681)
            || InArea(10000, 16002682));
    DeleteMapSFX(16003680, true);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002690, Restart, function(X0_4, X4_4, X8_4) {
    DisableNetworkSync();
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16000800));
    EnableAsset(X4_4);
    ForceAnimationPlayback(X4_4, 0, false, false, false);
    WaitFor(EventFlag(16002695));
    if (!EventFlag(X0_4)) {
        DisableAsset(X4_4);
        DeleteAssetfollowingSFX(X8_4, true);
        EndEvent();
    }
    CreateAssetfollowingSFX(X8_4, 90, 6102);
    ForceAnimationPlayback(X4_4, 0, false, false, false);
    EnableObjAct(X4_4, 99340);
    SetEventFlagID(16007690, OFF);
});

$Event(16002691, Restart, function(X0_4, X4_4, X8_4) {
    EndIf(EventFlag(16000800) || !PlayerIsInOwnWorld());
    WaitFor(ActionButtonInArea(9532, X4_4) && EventFlag(16002696));
    DeleteAssetfollowingSFX(X4_4, true);
    IssueShortWarpRequest(10000, TargetEntityType.Area, X8_4, -1);
    ForceAnimationPlayback(10000, 60530, false, false, false);
    ForceAnimationPlayback(X0_4, 1, false, false, false);
    WaitFixedTimeSeconds(2.8);
    DisableAsset(X0_4);
    WaitFixedTimeSeconds(0.1);
    AwardItemLot(16000690);
});

$Event(16002695, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16000800));
    WaitFor(PlayerIsInOwnWorld() && InArea(10000, 16002165));
    if (!(PlayerHasItemIncludingBBox(ItemType.Weapon, 17030000)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030001)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030002)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030003)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030004)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030005)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030006)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030007)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030008)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030009)
        || PlayerHasItemIncludingBBox(ItemType.Weapon, 17030010))) {
        SetEventFlagID(16002696, ON);
    }
});

$Event(16002800, Restart, function() {
    EndIf(EventFlag(16000800));
    WaitFor(CharacterHPValue(16000800) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(16008000, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(16000800));
    HandleBossDefeatAndDisplayBanner(16000800, TextBannerType.DemigodFelled);
    TriggerMultiplayerEvent(0);
    SetEventFlagID(16000800, ON);
    SetEventFlagID(9122, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61122, ON);
    }
    ClearSpEffect(10000, 1908);
    DeleteMapSFX(16002810, true);
    DeleteMapSFX(16002811, true);
    DeleteMapSFX(16002812, true);
    DeleteMapSFX(16002813, true);
    DeleteMapSFX(16002814, true);
    ChangeCamera(0, 0);
});

$Event(16002810, Restart, function() {
    if (EventFlag(16000800)) {
        DisableCharacter(16005800);
        DisableCharacterCollision(16005800);
        ForceCharacterDeath(16005800, false);
        EndEvent();
    }
L0:
    DisableCharacterAI(16005800);
    EnableCharacterInvincibility(16000801);
    DisableCharacter(16000800);
    DisableCharacterCollision(16000800);
    DisableCharacterFadeOnEnable(16000800);
    WaitFor(
        (PlayerIsInOwnWorld() && EntityInRadiusOfEntity(10000, 16000801, 40, 1))
            || HasDamageType(16000800, 10000, DamageType.Unspecified)
            || CharacterHasStateInfo(16000800, 436)
            || CharacterHasStateInfo(16000800, 2)
            || CharacterHasStateInfo(16000800, 5)
            || CharacterHasStateInfo(16000800, 6)
            || CharacterHasStateInfo(16000800, 260));
    SetNetworkconnectedEventFlagID(16000801, ON);
    Goto(L2);
L1:
    WaitFor(EventFlag(16002805) && InArea(10000, 16002800));
L2:
    SetSpEffect(10000, 1908);
    EnableCharacterAI(16000801);
    DisableCharacterInvincibility(16000801);
    SetNetworkUpdateRate(16000801, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 16000801, 0, 904710000);
    SetEventFlagID(16002803, ON);
    EnableLockOnPoint(16000801, 220);
    DisableLockOnPoint(16000801, 221);
    SetEventFlagID(16002801, ON);
    ForceAnimationPlayback(16000801, 20002, false, false, false);
});

$Event(16002811, Restart, function() {
    EndIf(EventFlag(16000800));
    WaitFor(PlayerIsInOwnWorld() && HPRatio(16000801) <= 0.01);
    ForceAnimationPlayback(16000801, 20001, false, false, false);
    WaitFor(PlayerIsInOwnWorld() && !CharacterDead(10000) && CharacterHasSpEffect(16000801, 11920));
    ForceAnimationPlayback(16000801, 30001, true, false, false);
    ClearSpEffect(16000801, 11943);
    ClearSpEffect(16000801, 11948);
    EndIf(HPRatio(10000) == 0 || CharacterDead(10000));
    if (PlayerIsInOwnWorld()) {
        PlayCutsceneToPlayerAndWarp(16000020, CutscenePlayMode.Skippable, 16002830, 16, 10000, 16, false);
    } else {
        PlayCutsceneToPlayer(16000020, CutscenePlayMode.Skippable, 10000);
    }
    WaitFixedTimeRealFrames(1);
    if (PlayerIsInOwnWorld()) {
        SetCameraAngle(-4, 0);
    }
    SetEventFlagID(16002802, ON);
    SetSpEffect(16000800, 11901);
    DisableCharacter(16000801);
    DisableCharacterCollision(16000801);
    EnableCharacter(16000800);
    SetNetworkUpdateRate(16000800, true, CharacterUpdateFrequency.AlwaysUpdate);
    SpawnMapSFX(16002814);
    WarpCharacterAndCopyFloor(16000800, TargetEntityType.Area, 16002831, 0, 16000801);
    WaitFixedTimeFrames(1);
    EnableCharacterCollision(16000800);
    EnableCharacterAI(16000800);
    DisplayBossHealthBar(Enabled, 16000800, 0, 904710001);
    DisableLockOnPoint(16000800, 220);
    EnableLockOnPoint(16000800, 221);
    ForceAnimationPlayback(16000800, 20002, false, true, false);
});

$Event(16002812, Restart, function() {
    EndIf(EventFlag(16000800));
    WaitFor(HPRatio(16000800) <= 0.65);
    SetSpEffect(16000800, 11902);
});

$Event(16002813, Restart, function() {
    EndIf(EventFlag(16000800)); 
    if (EntityInRadiusOfEntity(10000, 16000801, 77.3, 1)) {
        ChangeCamera(4641, 4641);
    }
    //if (!EntityInRadiusOfEntity(10000, 16000801, 25, 1)) {
    //    ChangeCamera(0, 0);
    //}
    WaitFixedTimeSeconds(5);
    RestartEvent();
});

$Event(16002814, Restart, function() {
    EndIf(EventFlag(16000800)); 
    if (EntityInRadiusOfEntity(10000, 16000800, 77.3, 1)) {
        ChangeCamera(4641, 4641);
    }
    //if (!EntityInRadiusOfEntity(10000, 16000800, 25, 1)) {
    //    ChangeCamera(0, 0);
    //}
    WaitFixedTimeSeconds(5);
    RestartEvent();
});

$Event(16002822, Restart, function() {
    WaitFor(
        CharacterBackreadStatus(16000800)
            && (CharacterHasSpEffect(16000800, 11901) || CharacterHasSpEffect(16000800, 11902))
            && CharacterHasSpEffect(16000800, 11940)
            && !CharacterHasSpEffect(16000800, 11930)
            && !CharacterHasSpEffect(16000800, 11931)
            && !CharacterHasSpEffect(16000800, 11941)
            && !CharacterHasSpEffect(16000800, 11946)
            && !CharacterHasSpEffect(16000800, 11947));
    WaitFixedTimeSeconds(3);
    SpawnMapSFX(16002810);
    SetSpEffect(16000800, 11930);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002824, Restart, function() {
    WaitFor(
        CharacterBackreadStatus(16000800)
            && (CharacterHasSpEffect(16000800, 11901) || CharacterHasSpEffect(16000800, 11902))
            && CharacterHasSpEffect(16000800, 11940)
            && CharacterHasSpEffect(16000800, 11930)
            && !CharacterHasSpEffect(16000800, 11931)
            && !CharacterHasSpEffect(16000800, 11941)
            && !CharacterHasSpEffect(16000800, 11946)
            && !CharacterHasSpEffect(16000800, 11947));
    WaitFixedTimeSeconds(3);
    SpawnMapSFX(16002811);
    DeleteMapSFX(16002810, true);
    SetSpEffect(16000800, 11931);
    ClearSpEffect(16000800, 11930);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002826, Restart, function() {
    WaitFor(
        CharacterBackreadStatus(16000800)
            && (CharacterHasSpEffect(16000800, 11901) || CharacterHasSpEffect(16000800, 11902))
            && CharacterHasSpEffect(16000800, 11940)
            && CharacterHasSpEffect(16000800, 11931)
            && !CharacterHasSpEffect(16000800, 11930)
            && !CharacterHasSpEffect(16000800, 11941)
            && !CharacterHasSpEffect(16000800, 11946)
            && !CharacterHasSpEffect(16000800, 11947));
    WaitFixedTimeSeconds(3);
    SpawnMapSFX(16002812);
    DeleteMapSFX(16002811, true);
    SetSpEffect(16000800, 11941);
    ClearSpEffect(16000800, 11931);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002830, Restart, function() {
    EndIf(EventFlag(16000800));
    WaitFor(CharacterHasSpEffect(16000800, 11942));
    SpawnMapSFX(16002813);
    ClearSpEffect(16000800, 11941);
    SetSpEffect(16000800, 11947);
    ShootBullet(16000800, 16001800, 100, 247100510, 0, 0, 0);
    ShootBullet(16000800, 16001800, 100, 247100810, 0, 0, 0);
    ShootBullet(16000800, 16001800, 100, 247100820, 0, 0, 0);
    ShootBullet(16000800, 16001800, 100, 247100830, 0, 0, 0);
    WaitFixedTimeSeconds(25);
    SetSpEffect(16000800, 11945);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002832, Restart, function() {
    WaitFor(CharacterHasSpEffect(16000800, 11946));
    DeleteMapSFX(16002810, true);
    DeleteMapSFX(16002811, true);
    DeleteMapSFX(16002812, true);
    DeleteMapSFX(16002813, true);
    ClearSpEffect(16000800, 11941);
    ClearSpEffect(16000800, 11945);
    ClearSpEffect(16000800, 11947);
    ClearSpEffect(16000800, 11946);
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002836, Restart, function() {
    DisableNetworkSync();
    EndIf(EventFlag(16000800));
    EndIf(EventFlag(16002802));
    if (PlayerIsInOwnWorld()) {
        WaitFor(!EventFlag(16002802) && EventFlag(16002801) && EventFlag(16002805));
        //ChangeCamera(4710, 4712);
        EndEvent();
    }
L0:
    WaitFor(!EventFlag(16002802) && EventFlag(16002806) && EventFlag(16002801));
    //ChangeCamera(4710, 4712);
});

$Event(16002838, Restart, function() {
    DisableNetworkSync();
    EndIf(EventFlag(16000800));
    if (PlayerIsInOwnWorld()) {
        WaitFor(EventFlag(16002802) && EventFlag(16002805));
        //ChangeCamera(4710, 4711);
        EndEvent();
    }
L0:
    WaitFor(EventFlag(16002802) && EventFlag(16002806));
    //ChangeCamera(4710, 4711);
});

$Event(16002840, Restart, function() {
    DisableNetworkSync();
    EndIf(EventFlag(16000800));
    GotoIf(L1, InArea(10000, 16002164));
    Goto(L0);
L1:
    SetSpEffect(10000, 1908);
L0:
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

$Event(16002842, Restart, function(X0_4) {
    EndIf(EventFlag(16000800));
    WaitFor(
        CharacterHasSpEffect(X0_4, 1929)
            || CharacterHasSpEffect(X0_4, 1930)
            || CharacterHasSpEffect(X0_4, 1931)
            || CharacterHasSpEffect(X0_4, 1932));
    GotoIf(L0, CharacterHasSpEffect(X0_4, 1929));
    GotoIf(L1, CharacterHasSpEffect(X0_4, 1930));
    GotoIf(L2, CharacterHasSpEffect(X0_4, 1931));
    GotoIf(L3, CharacterHasSpEffect(X0_4, 1932));
L0:
    GotoIf(S0, NumberOfCoopClients() == 0);
    GotoIf(S1, NumberOfCoopClients() == 1);
    GotoIf(S2, NumberOfCoopClients() == 2);
S0:
    SetSpEffect(X0_4, 19450);
    Goto(L10);
S1:
    SetSpEffect(X0_4, 19451);
    Goto(L10);
S2:
    SetSpEffect(X0_4, 19452);
    Goto(L10);
L1:
    GotoIf(S3, NumberOfCoopClients() == 0);
    GotoIf(S4, NumberOfCoopClients() == 1);
    GotoIf(S5, NumberOfCoopClients() == 2);
S3:
    SetSpEffect(X0_4, 19455);
    Goto(L10);
S4:
    SetSpEffect(X0_4, 19456);
    Goto(L10);
S5:
    SetSpEffect(X0_4, 19457);
    Goto(L10);
L2:
    GotoIf(S6, NumberOfCoopClients() == 0);
    GotoIf(S7, NumberOfCoopClients() == 1);
    GotoIf(S8, NumberOfCoopClients() == 2);
S6:
    SetSpEffect(X0_4, 19460);
    Goto(L10);
S7:
    SetSpEffect(X0_4, 19461);
    Goto(L10);
S8:
    SetSpEffect(X0_4, 19462);
    Goto(L10);
L3:
    GotoIf(S9, NumberOfCoopClients() == 0);
    GotoIf(S10, NumberOfCoopClients() == 1);
    GotoIf(S11, NumberOfCoopClients() == 2);
S9:
    SetSpEffect(X0_4, 19465);
    Goto(L10);
S10:
    SetSpEffect(X0_4, 19466);
    Goto(L10);
S11:
    SetSpEffect(X0_4, 19467);
    Goto(L10);
L10:
    WaitFixedTimeFrames(15);
    RestartEvent();
});

$Event(16002846, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4, X24_4, X28_4) {
    if (!EventFlag(X0_4)) {
        WaitFixedTimeFrames(1);
        if (X24_4 != 0) {
            GotoIf(L0, EventFlag(X24_4));
            if (X28_4 != 0) {
                areaFlag |= InArea(10000, X28_4);
            }
            areaFlag |= EventFlag(X24_4);
            WaitFor((areaFlag && PlayerIsInOwnWorld()) || EventFlag(X0_4));
            RestartIf(EventFlag(X0_4));
            Goto(L1);
        }
L0:
        if (PlayerIsInOwnWorld()) {
            WaitFor(
                EventFlag(X0_4)
                    || (PlayerIsInOwnWorld() && !EventFlag(X0_4) && ActionButtonInArea(X20_4, X4_4)));
            GotoIf(L2, !PlayerIsInOwnWorld());
            RestartIf(EventFlag(X0_4));
            SuppressSoundForFogGate(5);
            if (!CharacterHasSpEffect(10000, 4250)) {
                RotateCharacter(10000, X8_4, 60060, true);
            } else {
                RotateCharacter(10000, X8_4, 60060, false);
            }
        }
L3:
        GotoIf(L1, EventFlag(X12_4));
        time = ElapsedSeconds(3);
        WaitFor(
            ((InArea(10000, X8_4) || time) && PlayerIsInOwnWorld() && !EventFlag(X0_4))
                || EventFlag(X0_4));
        RestartIf(EventFlag(X0_4));
        RestartIf(time.Passed);
        WaitFor(PlayerIsInOwnWorld() && EntityInRadiusOfEntity(16000801, 10000, 40, 1));
L1:
        if (PlayerIsInOwnWorld()) {
            IssueBossRoomEntryNotification();
            SetNetworkUpdateAuthority(X16_4, AuthorityLevel.Forced);
        }
L2:
        ActivateMultiplayerdependantBuffs(X16_4);
        SetNetworkconnectedEventFlagID(X12_4, ON);
        EndIf(!PlayerIsInOwnWorld());
        RestartEvent();
    }
L10:
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(
        PlayerIsInOwnWorld()
            && EventFlag(X0_4)
            && (HasMultiplayerState(MultiplayerState.Invasion)
                || HasMultiplayerState(MultiplayerState.InvasionPending))
            && ActionButtonInArea(10000, X4_4));
    RotateCharacter(10000, X8_4, 60060, true);
    SendInvadingPhantomsHome(0);
    RestartEvent();
});

$Event(16002849, Restart, function() {
    InitializeEvent(0, 16002846, 16000800, 16001801, 16002801, 16002805, 16005800, 10000, 0, 0);
    InitializeCommonEvent(0, 9005801, 16000800, 16001801, 16002801, 16002805, 16002806, 10000);
    InitializeCommonEvent(0, 9005811, 16000800, 16001801, 3, 0);
    InitializeCommonEvent(0, 9005822, 16000800, 471000, 16002805, 16002806, 16002803, 16002802, 0, 0);
});

$Event(16002850, Restart, function() {
    EndIf(EventFlag(16000850));
    WaitFor(CharacterHPValue(16000850) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(16008000, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(16000850));
    HandleBossDefeatAndDisplayBanner(16000850, TextBannerType.GreatEnemyFelled);
    SetEventFlagID(16000850, ON);
    SetEventFlagID(9121, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61121, ON);
    }
    EnableAssetTreasure(16001681);
    DeleteAssetfollowingSFX(16001682, true);
    WaitFixedTimeSeconds(4);
    //Fix for elevator glitch if the player jumps on the lift too soon
    SetEventFlagID(16000520, OFF);
    EnableObjAct(16001522, -1);
    //ForceAnimationPlayback(16001520, 21, false, true, false);
    //ForceAnimationPlayback(16001520, 110, false, true, false);
    //ForceAnimationPlayback(16001520, 10, true, false, false);
});

$Event(16002855, Restart, function() {
    if (EventFlag(16000850)) {
        DisableCharacter(16000850);
        DisableCharacterCollision(16000850);
        ForceCharacterDeath(16000850, false);
        DeleteAssetfollowingSFX(16001682, true);
        if (!EventFlag(16007710)) {
            EnableAssetTreasure(16001681);
        }
        EndEvent();
    }
L0:
    DisableAssetTreasure(16001681);
    CreateAssetfollowingSFX(16001682, 90, 6101);
    DisableCharacterAI(16000850);
    EnableCharacterInvincibility(16000850);
    if (!EventFlag(16000851)) {
        DisableCharacter(16000850);
        DisableCharacterCollision(16000850);
        ForceAnimationPlayback(16000850, 30001, true, false, false);
        WaitFor(
        (PlayerIsInOwnWorld() && EntityInRadiusOfEntity(10000, 16000850, 30, 1) && InArea(10000, 16002852))
                || HasDamageType(16000850, 10000, DamageType.Unspecified)
                || CharacterHasStateInfo(16000850, 436)
                || CharacterHasStateInfo(16000850, 2)
                || CharacterHasStateInfo(16000850, 5)
                || CharacterHasStateInfo(16000850, 6)
                || CharacterHasStateInfo(16000850, 260));
        SetNetworkconnectedEventFlagID(16000851, ON);
        EnableCharacter(16000850);
        EnableCharacterCollision(16000850);
        EnableCharacterAI(16000850);
        ForceAnimationPlayback(16000850, 20001, false, true, false);
    } else {
L1:
        WaitFor(EventFlag(16002855) && InArea(10000, 16002850));
    }
L2:
    EnableCharacterAI(16000850);
    DisableCharacterInvincibility(16000850);
    SetNetworkUpdateRate(16000850, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 16000850, 0, 903570000);
});

$Event(16002860, Restart, function() {
    EndIf(EventFlag(16000860));
    WaitFor(CharacterDead(16000860));
    HandleBossDefeatAndDisplayBanner(16000860, TextBannerType.EnemyFelled);
    SetEventFlagID(16000860, ON);
    SetEventFlagID(9129, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61129, ON);
    }
});

$Event(16002865, Restart, function() {
    if (EventFlag(16000860)) {
        DisableCharacter(16000860);
        DisableCharacterCollision(16000860);
        ForceCharacterDeath(16000860, false);
        EndEvent();
    }
L0:
    DisableCharacterAI(16000860);
    EnableCharacterInvincibility(16000860);
    WaitFor(EventFlag(16002865) && InArea(10000, 16002860));
    EnableCharacterAI(16000860);
    DisableCharacterInvincibility(16000860);
    SetNetworkUpdateRate(16000860, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 16000860, 0, 904470000);
});

$Event(16002889, Default, function() {
    InitializeCommonEvent(0, 9005800, 16000860, 16001860, 16002860, 16002865, 16005860, 10000, 0, 0);
    InitializeCommonEvent(0, 9005801, 16000860, 16001860, 16002860, 16002865, 16002866, 10000);
    InitializeCommonEvent(0, 9005811, 16000860, 16001860, 4, 0);
    InitializeCommonEvent(0, 9005811, 16000860, 16001861, 5, 0);
    InitializeCommonEvent(0, 9005822, 16000860, 931000, 16002865, 16002866, 0, 16002862, 0, 0);
});

$Event(16002899, Default, function() {
    InitializeCommonEvent(0, 9005800, 16000850, 16001850, 16002850, 16002855, 16005850, 10000, 16000851, 0);
    InitializeCommonEvent(0, 9005801, 16000850, 16001850, 16002850, 16002855, 16002856, 10000);
    InitializeCommonEvent(0, 9005811, 16000850, 16001850, 4, 16000851);
    InitializeCommonEvent(0, 9005811, 16000850, 16001851, 3, 0);
    InitializeCommonEvent(0, 9005822, 16000850, 356000, 16002855, 16002856, 0, 16002852, 0, 0);
});

$Event(16009000, Restart, function() {
    WaitForEventFlag(ON, TargetEventFlagType.EventFlag, 16009213);
    WaitFor(CharacterBackreadStatus(10000));
    PlayCutsceneToPlayerAndWarp(16000010, CutscenePlayMode.Skippable, 16002840, 16000000, 10000, 0, false);
    WaitFixedTimeRealFrames(1);
    SetEventFlagID(16009213, OFF);
    ForceAnimationPlayback(20000, 60451, false, false, false);
});

$Event(16002900, Restart, function() {
    WaitFor(EntityInRadiusOfEntity(10000, 16000801, 30, 1));
    SetLockcamSlotNumber(16, 0, 1);
    WaitFor(!EntityInRadiusOfEntity(10000, 16000801, 30, 1));
    SetLockcamSlotNumber(16, 0, 0);
    RestartEvent();
});

$Event(16003700, Restart, function(X0_4, X4_4, X8_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3100)) {
            SetEventFlagID(16009205, OFF);
        }
    }
L10:
    if (!EventFlag(3105)) {
        if (!EventFlag(3106)) {
            if (!EventFlag(3107)) {
                if (!EventFlag(3108)) {
                    DisableCharacter(X0_4);
                    SetCharacterBackreadState(X0_4, true);
                    EnableCharacterGravity(X0_4);
                    DisableCharacter(X8_4);
                    SetCharacterBackreadState(X8_4, true);
                    WaitFor(
                        EventFlag(3105) || EventFlag(3106) || EventFlag(3107) || EventFlag(3108));
                    RestartEvent();
                }
            }
        }
    }
L5:
    GotoIf(L1, EventFlag(3100));
    GotoIf(L2, EventFlag(3101));
    GotoIf(L3, EventFlag(3102));
    GotoIf(L4, EventFlag(3103));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X8_4, false);
    EnableCharacter(X8_4);
    DisableCharacterGravity(X0_4);
    IssueShortWarpRequest(X0_4, TargetEntityType.Area, X4_4, -1);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    ForceAnimationPlayback(X8_4, 930010, false, false, false);
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(!(EventFlag(3105) || EventFlag(3106) || EventFlag(3107) || EventFlag(3108)));
    RestartEvent();
});

$Event(16003701, Restart, function(X0_4, X4_4, X8_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3100)) {
            SetEventFlagID(16009205, OFF);
        }
    }
L10:
    if (!EventFlag(3109)) {
        if (!EventFlag(3110)) {
            if (!EventFlag(3111)) {
                DisableCharacter(X0_4);
                SetCharacterBackreadState(X0_4, true);
                DisableCharacter(X4_4);
                SetCharacterBackreadState(X4_4, true);
                WaitFor(EventFlag(3109) || EventFlag(3110) || EventFlag(3111));
                RestartEvent();
            }
        }
    }
L5:
    EnableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, false);
    WarpAssetToCharacter(X8_4, X0_4, -1);
    GotoIf(L1, EventFlag(3100));
    GotoIf(L2, EventFlag(3101));
    GotoIf(L3, EventFlag(3102));
    GotoIf(L4, EventFlag(3103));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.FriendlyNPC);
    ForceAnimationPlayback(X0_4, 90101, false, false, false);
    if (EventFlag(3110)) {
        ForceAnimationPlayback(X0_4, 90102, false, false, false);
        DisableCharacterCollision(X0_4);
    }
    if (EventFlag(3111)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
    }
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    if (EventFlag(3111)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
    }
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    if (EventFlag(3111)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
    }
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    if (EventFlag(3111)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
    }
    Goto(L20);
L20:
    WaitFor(!(EventFlag(3109) || EventFlag(3110) || EventFlag(3111)));
    RestartEvent();
});

$Event(16003702, Restart, function(X0_4) {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3105));
    WaitFor(EventFlag(X0_4));
    SetEventFlagID(3118, ON);
    EndEvent();
});

$Event(16003703, Restart, function(X0_4, X4_4, X8_4) {
    RequestAssetRestoration(X0_4);
    EnableAssetInvunerability(X0_4);
    RequestAssetRestoration(X4_4);
    EnableAssetInvunerability(X4_4);
    RequestAssetRestoration(X8_4);
    EnableAssetInvunerability(X8_4);
    EndEvent();
});

$Event(16003704, Restart, function(X0_4, X4_4, X8_4) {
    EndIf(EventValue(16009260, 3) >= 3);
    EndIf(EventFlag(3109));
    EndIf(EventFlag(3110));
    EndIf(EventFlag(3111));
    ClearEventValue(16009260, 3);
    EndIf(!EventFlag(X0_4));
    IncrementEventValue(16009260, 3, 3);
    EndIf(!EventFlag(X4_4));
    IncrementEventValue(16009260, 3, 3);
    SetEventFlagID(3438, ON);
    EndIf(!EventFlag(X8_4));
    IncrementEventValue(16009260, 3, 3);
    SetEventFlagID(3118, ON);
    EndEvent();
});

$Event(16003705, Restart, function(X0_4, X4_4) {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    DisableCharacterImmortality(X4_4);
    if (!(EventFlag(16009265) && !EventFlag(16009264))) {
        EndIf(EventFlag(16009264));
        EndIf(!EventFlag(3109));
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, false);
        EnableCharacterImmortality(X4_4);
        SetCharacterTalkRange(X4_4, 50);
        WaitFor(HasDamageType(X4_4, 10000, DamageType.Unspecified) && !EventFlag(9000));
        SetEventFlagID(16009265, ON);
        ForceAnimationPlayback(X4_4, 90201, false, false, false);
        SetCharacterTalkRange(X4_4, 17);
        WaitFixedTimeSeconds(7);
        EnableCharacter(X0_4);
        EnableCharacterInvincibility(X0_4);
        ForceAnimationPlayback(X0_4, 20021, false, false, false);
        SetSpEffect(X0_4, 9650);
        SetSpEffect(X0_4, 5005);
        DisplayBlinkingMessageWithPriority(80020, 0, false);
        WaitFixedTimeSeconds(1);
        DisableCharacterInvincibility(X0_4);
        SetSpEffect(X0_4, 5006);
        DisableCharacter(X4_4);
        SetCharacterBackreadState(X4_4, true);
        EndEvent();
    }
L1:
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    WaitFor(EntityInRadiusOfEntity(10000, X4_4, 10, 1) && !EventFlag(9000));
    SetCharacterBackreadState(X4_4, true);
    WaitFixedTimeSeconds(2);
    EnableCharacter(X0_4);
    EnableCharacterInvincibility(X0_4);
    ForceAnimationPlayback(X0_4, 20021, false, false, false);
    SetSpEffect(X0_4, 9650);
    SetSpEffect(X0_4, 5005);
    DisplayBlinkingMessageWithPriority(80020, 0, false);
    WaitFixedTimeSeconds(1);
    DisableCharacterInvincibility(X0_4);
    SetSpEffect(X0_4, 5006);
    WaitFixedTimeSeconds(4);
    DisableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, true);
    EndEvent();
});

$Event(16003706, Restart, function(X0_4, X4_4) {
    EndIf(EventFlag(16009264));
    WaitFor(CharacterDead(X0_4));
    DisplayBlinkingMessageWithPriority(80021, 0, false);
    SetEventFlagID(16009264, ON);
    AwardItemLot(16000950);
    EnableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, false);
    DisableCharacterCollision(X4_4);
    ForceAnimationPlayback(X4_4, 90007, false, false, false);
    WaitFixedTimeSeconds(2);
    ForceAnimationPlayback(X4_4, 90202, false, false, false);
    EndEvent();
});

$Event(16003707, Restart, function(X0_4, X4_4) {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(X4_4));
    EndIf(EventFlag(16009208));
    WaitFor(!EventFlag(16009208) && EventFlag(16000800) && !CharacterBackreadStatus(X0_4));
    SetEventFlagID(X4_4, ON);
    EndEvent();
});

$Event(16003708, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16009266));
    if (!EventFlag(16009264)) {
        WaitFor(EventFlag(16009264));
        WaitFixedTimeSeconds(3);
    }
L1:
    SetEventFlagID(16009266, ON);
    EndEvent();
});

$Event(16003710, Restart, function(X0_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3680)) {
            SetEventFlagID(31009205, OFF);
        }
    }
L10:
    if (!EventFlag(3689)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
        WaitFor(EventFlag(3689));
        RestartEvent();
    }
L5:
    GotoIf(L1, EventFlag(3680));
    GotoIf(L2, EventFlag(3681));
    GotoIf(L3, EventFlag(3682));
    GotoIf(L4, EventFlag(3683));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3689));
    RestartEvent();
});

$Event(16003711, Restart, function(X0_4, X4_4) {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3681));
    BatchSetNetworkconnectedEventFlags(3680, 3684, OFF);
    SetNetworkconnectedEventFlagID(3680, ON);
    SaveRequest();
    SetEventFlagID(X4_4, OFF);
    SetCharacterTeamType(X0_4, TeamType.Disabled);
    SetNetworkconnectedEventFlagID(3698, ON);
    EndEvent();
});

$Event(16003712, Restart, function() {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16000800));
    WaitFor(EventFlag(16000800));
    EndIf(EventFlag(3689));
    EndIf(EventFlag(3690));
    EndIf(EventFlag(3691));
    EndIf(EventFlag(3692));
    BatchSetNetworkconnectedEventFlags(3680, 3684, OFF);
    SetNetworkconnectedEventFlagID(3683, ON);
    SaveRequest();
    EndEvent();
});

$Event(16003720, Restart, function(X0_4, X4_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3420)) {
            SetEventFlagID(1038519203, OFF);
        }
    }
L10:
    if (!EventFlag(3427)) {
        if (!EventFlag(3428)) {
            if (!EventFlag(3430)) {
                DisableCharacter(X0_4);
                SetCharacterBackreadState(X0_4, true);
                DisableCharacter(X4_4);
                SetCharacterBackreadState(X4_4, true);
                WaitFor(EventFlag(3427) || EventFlag(3428) || EventFlag(3430));
                RestartEvent();
            }
        }
    }
L5:
    GotoIf(L1, EventFlag(3420));
    GotoIf(L2, EventFlag(3421));
    GotoIf(L3, EventFlag(3422));
    GotoIf(L4, EventFlag(3423));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X4_4, true);
    DisableCharacter(X4_4);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    GotoIf(L20, EventFlag(3430));
    if (EventFlag(16009308) && !EventFlag(16002710)) {
        IssueShortWarpRequest(X0_4, TargetEntityType.Area, 16002730, -1);
        IssueShortWarpRequest(X4_4, TargetEntityType.Area, 16002730, -1);
    }
    GotoIf(L20, EventFlag(3428));
    if ((EventFlag(16009308) && !EventFlag(16002710) && !EventFlag(16009306)) || EventFlag(16002711)) {
        SetCharacterBackreadState(X0_4, true);
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X4_4, false);
        EnableCharacter(X4_4);
        ForceAnimationPlayback(X4_4, 930000, false, false, false);
    }
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(!(EventFlag(3427) || EventFlag(3428) || EventFlag(3430)));
    RestartEvent();
});

$Event(16003721, Restart, function(X0_4) {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3420));
    EndIf(EventFlag(X0_4));
    EndIf(EventFlag(16000800));
    WaitFor(EventFlag(X0_4));
    SetEventFlagID(3438, ON);
    EndEvent();
});

$Event(16003722, Restart, function(X0_4, X4_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3420)) {
            SetEventFlagID(1038519203, OFF);
        }
    }
L10:
    if (!EventFlag(3429)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
        DisableCharacter(X4_4);
        SetCharacterBackreadState(X4_4, true);
        WaitFor(EventFlag(3429));
        RestartEvent();
    }
L5:
    GotoIf(L1, EventFlag(3420));
    GotoIf(L2, EventFlag(3421));
    GotoIf(L3, EventFlag(3422));
    GotoIf(L4, EventFlag(3423));
L1:
    if (EventFlag(16009327)) {
        SetEventFlagID(16009329, ON);
    }
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X4_4, false);
    DisableCharacter(X4_4);
    ForceAnimationPlayback(X0_4, 90101, false, false, false);
    ForceAnimationPlayback(X4_4, 930020, false, false, false);
    GotoIf(L20, !EventFlag(16009329));
    ForceAnimationPlayback(X0_4, 90102, false, false, false);
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3429));
    RestartEvent();
});

$Event(16003723, Restart, function(X0_4, X4_4) {
    WaitFixedTimeFrames(1);
    EndIf(!EventFlag(3429));
    EndIf(EventFlag(3423));
    WaitFor(EventFlag(3423));
    WaitFixedTimeSeconds(3.5);
    EnableCharacter(X4_4);
    SetCharacterTeamType(X4_4, TeamType.Disabled);
    DisableCharacterCollision(X4_4);
    WaitFixedTimeSeconds(5);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    EndEvent();
});

$Event(16003724, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16009316));
    WaitFor(InArea(10000, 16002731));
    SetEventFlagID(16009316, ON);
    EndEvent();
});

$Event(16003725, Restart, function() {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3431));
    EndIf(!EventFlag(16009319));
    GotoIf(L1, EventFlag(16009327));
    Goto(L2);
L1:
    SetEventFlagID(16009338, ON);
    EndEvent();
L2:
    SetEventFlagID(16009337, ON);
    EndEvent();
});

$Event(16003726, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16000800));
    EndIf(EventFlag(16009208));
    EndIf(EventFlag(16009309));
    EndIf(!EventFlag(1038519205));
    WaitFixedTimeFrames(1);
    ForceAnimationPlayback(20000, 60451, false, false, false);
    SetEventFlagID(16009309, ON);
    EndEvent();
});

$Event(16003727, Restart, function() {
    WaitFixedTimeRealFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3429));
    WaitFixedTimeRealFrames(1);
    EndIf(
        !(!EventFlag(3105)
            && !EventFlag(3106)
            && !EventFlag(3107)
            && !EventFlag(3108)
            && !EventFlag(3689)
            && !EventFlag(3448)
            && !EventFlag(3449)
            && !EventFlag(3886)));
    SetEventFlagID(3438, ON);
    EndEvent();
});

$Event(16003730, Restart, function(X0_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    SetEventFlagID(16009400, OFF);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3440)) {
            SetEventFlagID(11109405, OFF);
        }
    }
L10:
    if (!EventFlag(3448)) {
        if (!(!EventFlag(16002731) && EventFlag(3449))) {
            if (!(!EventFlag(16009405) && EventFlag(3449))) {
                DisableCharacter(X0_4);
                SetCharacterBackreadState(X0_4, true);
                WaitFor(
                    EventFlag(3448)
                        || (!EventFlag(16002731) && EventFlag(3449))
                        || (!EventFlag(16009405) && EventFlag(3449)));
                RestartEvent();
            }
        }
    }
L5:
    GotoIf(L1, EventFlag(3440));
    GotoIf(L2, EventFlag(3441));
    GotoIf(L3, EventFlag(3442));
    GotoIf(L4, EventFlag(3443));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    if (EventFlag(3449)) {
        ForceAnimationPlayback(X0_4, 90105, false, false, false);
    }
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(
        !(EventFlag(3448)
            || (!EventFlag(16002731) && EventFlag(3449))
            || (!EventFlag(16009405) && EventFlag(3449))));
    RestartEvent();
});

$Event(16003731, Restart, function(X0_4, X4_4, X8_4) {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3449));
    EndIf(EventFlag(X0_4));
    SetEventFlagID(X0_4, ON);
    SetEventFlagID(X4_4, ON);
    WaitFixedTimeFrames(1);
    SetEventFlagID(X8_4, ON);
    EndEvent();
});

$Event(16003740, Restart, function(X0_4, X4_4, X8_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3880)) {
            SetEventFlagID(1042389253, OFF);
        }
    }
L10:
    if (!EventFlag(3886)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
        EnableCharacterGravity(X0_4);
        DisableAssetInvunerability(X4_4);
        WaitFor(EventFlag(3886));
        RestartEvent();
    }
L5:
    GotoIf(L1, EventFlag(3880));
    GotoIf(L2, EventFlag(3881));
    GotoIf(L3, EventFlag(3882));
    GotoIf(L4, EventFlag(3883));
L1:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    RequestAssetRestoration(X4_4);
    EnableAssetInvunerability(X4_4);
    DisableCharacterGravity(X0_4);
    IssueShortWarpRequest(X0_4, TargetEntityType.Area, X8_4, -1);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    GotoIf(L20, mainGroupAbuse);
L2:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3886));
    RestartEvent();
});

$Event(16003741, Restart, function(X0_4) {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!EventFlag(3880));
    EndIf(EventFlag(16009208));
    WaitFor(EventFlag(16009208));
    SetEventFlagID(3898, ON);
    WaitFixedTimeFrames(1);
    SetEventFlagID(X0_4, ON);
    EndEvent();
});

$Event(16003742, Restart, function(X0_4, X4_4, X8_4) {
    WaitFixedTimeFrames(1);
    DisableNetworkSync();
    if (PlayerIsInOwnWorld()) {
    }
L10:
    if (!EventFlag(3887)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
        DisableAsset(X4_4);
        EnableAsset(X8_4);
        WaitFor(EventFlag(3887));
        RestartEvent();
    }
L5:
    GotoIf(L1, EventFlag(3880));
    GotoIf(L2, EventFlag(3881));
    GotoIf(L3, EventFlag(3882));
    GotoIf(L4, EventFlag(3883));
L1:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableAsset(X4_4);
    DisableAsset(X8_4);
    GotoIf(L20, mainGroupAbuse);
L2:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableAsset(X4_4);
    DisableAsset(X8_4);
    Goto(L20);
L3:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableAsset(X4_4);
    DisableAsset(X8_4);
    Goto(L20);
L4:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableAsset(X4_4);
    DisableAsset(X8_4);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3887));
    RestartEvent();
});

$Event(16003743, Restart, function() {
    WaitFixedTimeFrames(1);
    EndIf(!PlayerIsInOwnWorld());
    EndIf(!(EventFlag(3887) && EventFlag(7605) && !EventFlag(400291)));
    SetEventFlagID(16009463, ON);
    EndEvent();
});

$Event(16003750, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    EndIf(!PlayerIsInOwnWorld());
    SetCharacterTalkRange(X0_4, 17);
    if (0 != X4_4) {
        SetCharacterTalkRange(X4_4, 17);
    }
    EndIf(EventFlag(X8_4));
    GotoIf(L1, !EventFlag(X12_4));
    Goto(L2);
L1:
    WaitFor(EventFlag(X12_4));
    Goto(L2);
L2:
    SetCharacterTalkRange(X0_4, X16_4);
    if (0 != X4_4) {
        SetCharacterTalkRange(X4_4, X16_4);
    }
    EndEvent();
});

$Event(16003760, Restart, function(X0_4) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3780) && EventFlag(16009503)) {
            SetEventFlagID(16009503, OFF);
        }
    }
L10:
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    if (!(EventFlag(3785) && EventFlag(16002756))) {
        WaitFor(EventFlag(3785) && EventFlag(16002756));
        RestartEvent();
    }
L0:
    SetCharacterTalkRange(X0_4, 80);
    GotoIf(L1, EventFlag(3780));
    GotoIf(L2, EventFlag(3781));
    GotoIf(L4, EventFlag(3783));
L1:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    Goto(L20);
L2:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(X0_4);
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    DisableAsset(X0_4);
    Goto(L20);
L20:
    WaitFor(!(EventFlag(3785) && EventFlag(16002756)));
    RestartEvent();
});

$Event(16003761, Restart, function(X0_4) {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(
        !EntityInRadiusOfEntity(10000, X0_4, 59, 1)
            && EventFlag(16002751)
            && !EventFlag(16009505)
            && EventFlag(16002756));
    IssueShortWarpRequest(X0_4, TargetEntityType.Area, 16002720, -1);
    SetEventFlagID(16009508, ON);
    EndEvent();
});

$Event(16003762, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4, X24_4) {
    DisableNetworkSync();
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(EventFlag(X20_4) && !AllBatchEventFlags(X12_4, X16_4));
    if (Signed(X24_4) != 0) {
        CreateAssetfollowingSFX(X0_4, 90, X24_4);
    } else {
        CreateAssetfollowingSFX(X0_4, 90, 6101);
    }
    flag = !EventFlag(X20_4) || AllBatchEventFlags(X12_4, X16_4);
    WaitFor(ActionButtonInArea(X4_4, X0_4) || flag);
    if (!flag.Passed) {
        DeleteAssetfollowingSFX(X0_4, true);
        AwardGesture(X8_4);
        SetNetworkconnectedEventFlagID(X12_4, ON);
        EndEvent();
    }
L0:
    DeleteAssetfollowingSFX(X0_4, true);
    RestartEvent();
});

$Event(16003763, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    GotoIf(L0, !EventFlag(16009509));
    GotoIf(L1, !EventFlag(16009510));
    GotoIf(L2, !EventFlag(16009511));
    Goto(L3);
L0:
    SetNetworkconnectedEventFlagID(16009509, ON);
    EndEvent();
L1:
    SetNetworkconnectedEventFlagID(16009510, ON);
    EndEvent();
L2:
    SetNetworkconnectedEventFlagID(16009511, ON);
    SetNetworkconnectedEventFlagID(16002756, ON);
    EndEvent();
L3:
    RandomlySetEventFlagInRange(16002752, 16002756, ON);
    EndEvent();
});

$Event(16003764, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16009505));
    WaitFor(
        !EventFlag(16009505)
            && !EventFlag(16009508)
            && !EventFlag(16002751)
            && InArea(10000, 16002721));
    SetNetworkconnectedEventFlagID(16002750, ON);
    EndEvent();
});

$Event(16003765, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(16009505));
    WaitFor(
        !EventFlag(16009505)
            && EventFlag(16009508)
            && !EventFlag(16002758)
            && InArea(10000, 16002722));
    SetNetworkconnectedEventFlagID(16002757, ON);
    EndEvent();
});

$Event(16003770, Default, function() {
    CreateAssetfollowingSFX(16000780, 200, 806870);
    IfActionButtonInArea(MAIN, 9140, 16000780);
    RotateCharacter(10000, 16000780, -1, true);
    ForceAnimationPlayback(10000, 60490, false, false, false, Equal, 1);
    WaitFixedTimeSeconds(3);
    WarpPlayer(60, 35, 54, 0, 1035541551, 60);
    RestartEvent();
});

$Event(16003780, Default, function() {
    CreateAssetfollowingSFX(16002081, 200, 806870);
    IfActionButtonInArea(MAIN, 9140, 16002081);
    RotateCharacter(10000, 16002081, -1, true);
    ForceAnimationPlayback(10000, 60490, false, false, false, Equal, 1);
    WaitFixedTimeSeconds(3);
    WarpPlayer(14, 0, 0, 0, 14002086, 60);
    SetPlayerRespawnPoint(14002086);
    SaveRequest();
    RestartEvent();
});

// Disabling cave assets when outside of it.
$Event(16001730, Restart, function() {
    for (let i = 1; i <= 8; i++) {
        DisableMapPart(16001730 + i);
    }
    WaitFor(InArea(10000, 16001739));
    for (let i = 1; i <= 8; i++) {
        EnableMapPart(16001730 + i);
    }
    WaitFor(!InArea(10000, 16001739));
    RestartEvent();
    
});

// Falling Teleport
$Event(16001731, Restart, function() {
    WaitFor(InArea(10000, 16002914));
    FadeToBlack(1, 2, false, 0);
    WaitFixedTimeFrames(78);
    IssueShortWarpRequest(10000, TargetEntityType.Area, 16002578, 0)
    WaitFixedTimeFrames(78);
    SetCameraAngle(10,-90);
    FadeToBlack(0, 1, false, 0);
    IssueShortWarpRequest(10000, TargetEntityType.Area, 16002576, 0)
});

$Event(16002587, Default, function() {
    EndIf(ThisEventSlot());
    SetEventFlagID(16000513, ON);
});

//Eleavtor
$Event(16001732, Default, function() {
    InitializeCommonEvent(0, 90005500, 16000513, 16000516, 0, 16001515, 16001517, 16003517, 16001516, 16003516, 16002516, 16002517, 16000517, 16000518, 0);
});

//Dropdown boi
$Event(16001733, Default, function() {
    InitializeCommonEvent(0, 90005706, 16000702, 30014, 0);
    SetSpEffect(16000702, 18699);
    SetSpEffect(16000702, 18696);
    EnableAssetInvunerability(16000703);
});
