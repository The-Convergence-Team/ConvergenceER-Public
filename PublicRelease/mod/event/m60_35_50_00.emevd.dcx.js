// ==EMEVD==
// @docs    er-common.emedf.json
// @compress    DCX_KRAK
// @game    Sekiro
// @string    "N:\\GR\\data\\Param\\event\\common_func.emevd\u0000N:\\GR\\data\\Param\\event\\common_macro.emevd\u0000\u0000\u0000\u0000\u0000\u0000"
// @linked    [0,82]
// @version    3.5
// ==/EMEVD==

$Event(0, Default, function() {
    RegisterBonfire(1035500002, 1035501953, 0, 0, 0, 5);
    RegisterBonfire(1035500000, 1035501950, 0, 0, 0, 5);
    RegisterBonfire(1035500001, 1035501951, 0, 0, 0, 5);
    InitializeCommonEvent(0, 90005100, 76214, 76214, 1035501983, 77220, 4, 78220, 78221, 78222, 78223, 78224, 78225, 78226, 78227, 78228, 78229);
    InitializeCommonEvent(0, 900005610, 1035501650, 100, 800, 0);
    InitializeCommonEvent(1, 900005610, 1035501651, 100, 800, 0);
    InitializeCommonEvent(2, 900005610, 1035501652, 100, 800, 0);
    InitializeCommonEvent(0, 90005300, 1035500322, 1035500322, 40220, 0, 0);
    InitializeCommonEvent(0, 90005300, 1035500320, 1035500320, 40250, 0, 0);
    InitializeEvent(0, 1035502200, 1035502700);
    InitializeEvent(0, 1035502580, 0); // Ladders
    InitializeEvent(0, 1035502510, 0); // Elevators
    InitializeCommonEvent(0, 90005511, 1035500560, 1035501560, 1035503560, 99020, 0);
    InitializeCommonEvent(0, 90005512, 1035500560, 1035502560, 1035502561);
    InitializeCommonEvent(0, 90005201, 1035500200, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500210, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500211, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005251, 1035500217, 1092616192, 0, -1);
    InitializeCommonEvent(0, 90005201, 1035500218, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500219, 30000, 20000, 1035502200, 1092616192, 1084227584, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500220, 30000, 20000, 1084227584, 1065353216, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500222, 30003, 20003, 1035502222, 1098907648, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500223, 30000, 20000, 1035502200, 1092616192, 1077936128, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500224, 30000, 20000, 1035502200, 1092616192, 1082130432, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500225, 30000, 20000, 1035502200, 1088421888, 1073741824, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500226, 30000, 20000, 1084227584, 1065353216, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500227, 30000, 20000, 1035502200, 1092616192, 1082130432, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500228, 30000, 20000, 1035502200, 1086324736, 1073741824, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500229, 30000, 20000, 1035502200, 1092616192, 1084227584, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500230, 30000, 20000, 1035502200, 1092616192, 1082130432, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500240, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500241, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500244, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500252, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500254, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500255, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500256, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500258, 30000, 20000, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500278, 30000, 20000, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500279, 30000, 20000, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500280, 30000, 20000, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500281, 30000, 20000, 1035502291, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500282, 30000, 20000, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500283, 30000, 20000, 1035502291, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005201, 1035500284, 30000, 20000, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1035500290, 30000, 20000, 1035502299, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1035500291, 30000, 20000, 1035502291, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1035500292, 30000, 20000, 1035502291, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1035500293, 30000, 20000, 1035502299, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005251, 1035500303, 1097859072, 0, -1);
    InitializeCommonEvent(0, 90005261, 1035500310, 1035502311, 1099956224, 0, -1);
    InitializeCommonEvent(0, 90005200, 1035500350, 30003, 20003, 1035502350, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500353, 30003, 20003, 1035502354, 1101004800, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005210, 1035500354, 30003, 20003, 1035502354, 1101004800, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1035500356, 30003, 20003, 1035502356, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005251, 1035500395, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005260, 1035500410, 1035502410, 1109917696, 0, -1);
    InitializeCommonEvent(0, 90005200, 1035500414, 30006, 20006, 1035502414, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005251, 1035500415, 1099431936, 0, -1);
    InitializeCommonEvent(0, 90005260, 1035500423, 1035502410, 1109393408, 0, -1);
    // Zone enemy activation - Entity ID, Region ID
    InitializeCommonEvent(0, 90005250, 1035500313, 1035502313, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500314, 1035502314, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500342, 1035502342, 0, 0);
    //InitializeCommonEvent(0, 90005250, 1035500390, 1035502390, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500391, 1035502391, 0, -1);
    InitializeCommonEvent(1, 90005250, 1035500394, 1035502391, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500400, 1035502400, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500401, 1035502400, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500402, 1035502402, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500409, 1035502409, 0, -1);
    InitializeCommonEvent(0, 90005250, 1035500416, 1035502416, 0, -1);
    // Carian Knight boss events, Carian Knight ID: 1035500800
    InitializeCommonEvent(0, 9005810, 1035500800, 76232, 1035500952, 1035501952, 1084227584);
    InitializeEvent(0, 1035502849, 0);
    InitializeEvent(0, 1035500800, 0);
    InitializeEvent(0, 1035502810, 0);
    InitializeEvent(0, 1035502840, 0);
    InitializeEvent(0, 1035502841, 0);
    InitializeEvent(0, 1035502842, 0);
    // Ainar boss events, Ainar ID: 1035500850
    InitializeCommonEvent(1, 9005810, 1035500850, 76261, 1035500954, 1035501954, 1084227584);
    InitializeCommonEvent(0, 98005309, 1035500850, 1035502880, 1035502881);
    InitializeEvent(0, 1035500850, 0);
    InitializeEvent(0, 1035502860, 0);
    InitializeEvent(0, 1035502861, 0);
    InitializeEvent(0, 1035502899, 0);
    // Traps
    InitializeEvent(0, 1035502210, 1035501600, 1035502600, 1035500399);
    InitializeEvent(1, 1035502210, 1035501601, 1035502601, 1035500399);
    InitializeEvent(2, 1035502210, 1035501602, 1035502602, 1035500399);
    InitializeEvent(3, 1035502210, 1035501603, 1035502603, 1035500399);
    InitializeEvent(4, 1035502210, 1035501604, 1035502604, 1035500399);
    InitializeEvent(5, 1035502210, 1035501605, 1035502605, 1035500399);
    InitializeEvent(6, 1035502210, 1035501606, 1035502606, 1035500399);
    InitializeEvent(7, 1035502210, 1035501607, 1035502607, 1035500399);
    InitializeEvent(8, 1035502210, 1035501608, 1035502608, 1035500399);
    InitializeEvent(9, 1035502210, 1035501609, 1035502609, 1035500399);
    InitializeEvent(10, 1035502210, 1035501610, 1035502610, 1035500399);
    InitializeEvent(11, 1035502210, 1035501611, 1035502611, 1035500399);
    InitializeEvent(12, 1035502210, 1035501612, 1035502612, 1035500399);
    //Pidia Related things v
    InitializeEvent(0, 1035500700, 1035500700, 1035500702, 1035500704, 1035500706, 1035501702);
    InitializeEvent(0, 1035500701, 1035500701, 1035500703, 1035500705, 1035500707, 1035501701);
    InitializeEvent(0, 1035500702, 0);
    InitializeEvent(0, 1035500703, 1035502705, 1035502720);
    InitializeEvent(1, 1035500703, 1035502706, 1035502721);
    InitializeCommonEvent(0, 90005750, 1035501700, 4110, 101490, 400149, 400149, 1035509215, 0);
    InitializeCommonEvent(0, 90005750, 1035501700, 4110, 101495, 400149, 400149, 1035509216, 0);
    // Pidia ^
    InitializeCommonEvent(0, 90005706, 1035500710, 90102, 0); // Sitting Spirit
    InitializeCommonEvent(0, 90005540, 1035500331, 1035501961, 1035501971, 1035501981, -1, 1, 2); // New Gates
    InitializeCommonEvent(1, 90005540, 1035500332, 1035501962, 1035501972, 1035501982, -1, 1, 2); // (eventflag, gate id, lever id, objecteventflag, objectparamid, anim id, anim id)
    InitializeCommonEvent(2, 90005540, 1035500333, 1035501963, 1035501973, 1035501983, -1, 1, 2);
    InitializeCommonEvent(0, 90005501, 1035500510, 1035500511, 4, 1035501510, 1035501511, 1035501512, 1035500512); // Old Elevator
    InitializeCommonEvent(0, 90005501, 1035500310, 1035500311, 0, 1035501310, 1035501311, 1035501312, 1035500312); // Caria Rise Elevator
    InitializeCommonEvent(0, 90005501, 1035500410, 1035500411, 5, 1035501410, 1035501411, 1035501412, 1035500412); // New Elevator
    // Adula Ambushes
    InitializeEvent(0, 1035508750, 0);
    InitializeEvent(0, 1035508751, 1035500750, 1035500759);
    InitializeEvent(1, 1035508751, 1035500759, 1035500753);
    InitializeEvent(2, 1035508751, 1035500753, 1035500756);
    InitializeEvent(3, 1035508751, 1035500756, 1034500800);
    InitializeEvent(0, 1035508755, 0);
    // Custom Puppets
    InitializeEvent(0, 1035508760, 1035500110, 0, 0, 0);
    InitializeEvent(1, 1035508760, 1035500111, 0, 0, 0);
    InitializeEvent(2, 1035508760, 1035500112, 0, 0, 0);
    InitializeEvent(3, 1035508760, 1035500113, 0, 0, 0);
    InitializeEvent(4, 1035508760, 1035500418, 0, 0, 0);
    InitializeEvent(5, 1035508760, 1035500425, 0, 0, 0);
    InitializeEvent(6, 1035508760, 1035500426, 0, 0, 0);
    InitializeEvent(7, 1035508760, 1035500138, 0, 0, 0);
    InitializeEvent(0, 1035508770, 1035500114, 0, 0, 1, 1035502114);
    InitializeEvent(1, 1035508770, 1035500115, 0, 0, 1, 1035502114);
    InitializeEvent(2, 1035508770, 1035500116, 0, 1706, 0, 1035502116);
    InitializeEvent(3, 1035508770, 1035500117, 0, 1001706, 0, 1035502116);
    InitializeEvent(4, 1035508770, 1035500118, 0, 0, 0, 1035502118);
    InitializeEvent(5, 1035508770, 1035500119, 0, 0, 1, 1035502119);
    InitializeEvent(5, 1035508770, 1035500120, 0, 0, 0, 1035502120);
    InitializeEvent(6, 1035508770, 1035500121, 0, 0, 0, 1035502120);
    InitializeEvent(7, 1035508770, 1035500122, 0, 0, 0, 1035502120);
    InitializeEvent(8, 1035508770, 1035500123, 0, 0, 1, 1035502123);
    InitializeEvent(9, 1035508770, 1035500124, 0, 0, 1, 1035502123);
    InitializeEvent(10, 1035508770, 1035500125, 0, 0, 0, 1035502125);
    InitializeEvent(11, 1035508770, 1035500126, 0, 0, 0, 1035502125);
    InitializeEvent(12, 1035508770, 1035500127, 0, 0, 0, 1035502125);
    InitializeEvent(13, 1035508770, 1035500128, 0, 0, 0, 1035502128);
    InitializeEvent(14, 1035508770, 1035500129, 0, 0, 0, 1035502128);
    InitializeEvent(15, 1035508770, 1035500130, 0, 3026, 1, 1035502130);
    InitializeEvent(16, 1035508770, 1035500131, 0, 0, 0, 1035502130);
    InitializeEvent(17, 1035508770, 1035500132, 0, 0, 0, 1035502130);
    InitializeEvent(18, 1035508770, 1035500133, 0, 0, 0, 1035502133);
    InitializeEvent(19, 1035508770, 1035500134, 0, 0, 0, 1035502133);
    InitializeEvent(20, 1035508770, 1035500135, 0, 0, 0, 1035502133);
    InitializeEvent(21, 1035508770, 1035500136, 0, 0, 0, 1035502133);
    InitializeEvent(22, 1035508770, 1035500137, 0, 0, 1, 1035502137);
    // Enemies Trapped in Crystals
    InitializeEvent(0, 1035508780, 1035500390, 1035500390, 1035502390, 0, 1035500710, 1035508390);
    InitializeEvent(1, 1035508780, 1035500392, 1035500392, 1035502392, 0, 1035500720, 1035508392);
    InitializeEvent(2, 1035508780, 1035500393, 1035500393, 1035502393, 0, 1035500700, 1035508393);
    // Frost NPC
    InitializeCommonEvent(0, 90005250, 1035500711, 1036502130, 0, -1);
    InitializeCommonEvent(0, 90005300, 1035500711, 1035500711, 108200, 0, 0);
    //Lever relocation light
    InitializeEvent(0, 1035500770,1035500769);
});

$Event(50, Default, function() {
    SetEventFlagID(1035500410, ON); // Elevator Up
    // Forced Fog
    InitializeEvent(0, 1035508790, 0);
    //SetEventFlagID(1035500510, OFF); // Elevator Down
});

$Event(1035502510, Default, function() {
    InitializeCommonEvent(0, 90005500, 1035500510, 1035500511, 4, 1035501510, 1035501511, 1035503511, 1035501512, 1035503512, 1035502511, 1035502512, 1035500512, 1035500513, 0); // Old Elevator
    InitializeCommonEvent(0, 90005500, 1035500310, 1035500311, 0, 1035501310, 1035501311, 1035503311, 1035501312, 1035503312, 1035502312, 1035502313, 1035500312, 1035500313, 0); // Rise Elevator
    InitializeCommonEvent(0, 90005500, 1035500410, 1035500411, 5, 1035501410, 1035501411, 1035503411, 1035501412, 1035503412, 1035502411, 1035502412, 1035500412, 1035500413, 0); // New Elevator
});

$Event(1035502580, Default, function() {
    RegisterLadder(1035500580, 1035500581, 1035501580);
    RegisterLadder(1035500580, 1035500581, 1035501581);
    RegisterLadder(1035500582, 1035500583, 1035501582);
    RegisterLadder(1035500582, 1035500583, 1035501583);
    RegisterLadder(1035500584, 1035500585, 1035501584);
    RegisterLadder(1035500584, 1035500585, 1035501585);
    RegisterLadder(1035500586, 1035500587, 1035501586);
    RegisterLadder(1035500586, 1035500587, 1035501587);
    RegisterLadder(1035500586, 1035500587, 1035501589);
    RegisterLadder(1035500586, 1035500587, 1035501590);
    InitializeCommonEvent(0, 90005520, 1035500203, 1035501588, 1035500588, 1035500589); // Kick Ladder
});

// Adula Ambushes - Core
$Event(1035508750, Restart, function() {
    EndIf(EventFlag(1034500800) || EventFlag(1034420800));
    WaitFixedTimeSeconds(2);
    WaitFor(InArea(20000, 1035500751) || InArea(20000, 1035500754) || (InArea(20000, 1035500757) && !EventFlag(1035508756)) || InArea(20000, 1035500760));
    
    if (InArea(20000, 1035500757) && !EventFlag(1035508756)) { // Zone 3 (Gate)
        EnableCharacter(1035500756);
        SetSpEffect(1035500756, 10124);
        WaitFixedTimeFrames(15);
        PlaySE(10000, SoundType.SFX, 530351);
        ForceAnimationPlayback(1035500756, 3001, false, false, false);
        WaitFixedTimeFrames(30);
        SpawnOneshotSFX(TargetEntityType.Character, 1035500756, 220, 510160);
        PlaySE(10000, SoundType.SFX, 303110);
        PlaySE(10000, SoundType.SFX, 500011);
        PlaySE(10000, SoundType.SFX, 523881);
        
        for (let i = 0; i < 15; i++) {
            WaitFixedTimeFrames(2);
            RotateCharacter(1035500756, 20000, -1, false);
        }
        EnableCharacterHPBarDisplay(1035500756);
        EnableCharacterCollision(1035500756);
        ClearSpEffect(1035500756, 10124);
        SetSpEffect(1035500756, 11730);
        PlaySE(10000, SoundType.SFX, 600920);
        PlaySE(10000, SoundType.SFX, 600921);
        WaitFixedTimeFrames(2);
        
        for (let i = 0; i < 56; i++) {
            WaitFixedTimeFrames(2);
            RotateCharacter(1035500756, 20000, -1, false);
        }
        WaitFixedTimeFrames(1);
        ClearSpEffect(1035500756, 11730);
        
        for (let i = 0; i < 7; i++) {
            WaitFixedTimeFrames(2);
            RotateCharacter(1035500756, 20000, -1, false);
        }
        WaitFixedTimeFrames(1);
        SetSpEffect(1035500756, 10124);
        
        WaitFixedTimeFrames(22);
        WaitFixedTimeFrames(100);
        DisableCharacterHPBarDisplay(1035500756);
        DisableCharacterCollision(1035500756);
        DisableCharacter(1035500756);
        
        WaitFixedTimeSeconds(25);
        //ForceCharacterDeath(1035500756, false);
    }
    else if (InArea(20000, 1035500754)) { // Zone 2 (Stairs)
        EnableCharacter(1035500753);
        SetSpEffect(1035500753, 10124);
        PlaySE(10000, SoundType.SFX, 530351);
        WaitFixedTimeFrames(45);
        SpawnOneshotSFX(TargetEntityType.Character, 1035500753, 220, 510160);
        PlaySE(10000, SoundType.SFX, 303110);
        PlaySE(10000, SoundType.SFX, 500011);
        PlaySE(10000, SoundType.SFX, 523881);
        WaitFixedTimeFrames(6);
        ForceAnimationPlayback(1035500753, 3027, false, false, false);
        WaitFixedTimeFrames(5);
        EnableCharacterHPBarDisplay(1035500753);
        EnableCharacterCollision(1035500753);
        ClearSpEffect(1035500753, 10124);
        SetSpEffect(1035500753, 11730);
        PlaySE(10000, SoundType.SFX, 600920);
        PlaySE(10000, SoundType.SFX, 600921);
        
        WaitFixedTimeFrames(70);
        ClearSpEffect(1035500753, 11730);
        WaitFixedTimeFrames(15);
        SetSpEffect(1035500753, 10124);
        
        WaitFixedTimeFrames(22); // Requiered
        //WaitFixedTimeFrames(60); // Cooldown
        DisableCharacterHPBarDisplay(1035500753);
        DisableCharacterCollision(1035500753);
        ForceAnimationPlayback(1035500753, 701, true, false, false);
        IssueShortWarpRequest(1035500753, TargetEntityType.Area, 1035500755, -1);
        ResetCharacterPosition(1035500753);
        DisableCharacter(1035500753);
    }
    else if (InArea(20000, 1035500760)) { // Zone 1.5 (Bridge)
        EnableCharacter(1035500759);
        SetSpEffect(1035500759, 10124);
        WaitFixedTimeFrames(15);
        PlaySE(10000, SoundType.SFX, 530351);
        WaitFixedTimeFrames(30);
        SpawnOneshotSFX(TargetEntityType.Character, 1035500759, 220, 510160);
        PlaySE(10000, SoundType.SFX, 303110);
        PlaySE(10000, SoundType.SFX, 500011);
        PlaySE(10000, SoundType.SFX, 523881);
        WaitFixedTimeFrames(10);
        ForceAnimationPlayback(1035500759, 3027, false, false, false);
        
        WaitFixedTimeFrames(5);
        EnableCharacterHPBarDisplay(1035500759);
        EnableCharacterCollision(1035500759);
        ClearSpEffect(1035500759, 10124);
        SetSpEffect(1035500759, 11730);
        PlaySE(10000, SoundType.SFX, 600920);
        PlaySE(10000, SoundType.SFX, 600921);
        
        WaitFixedTimeFrames(70);
        ClearSpEffect(1035500759, 11730);
        WaitFixedTimeFrames(15);
        SetSpEffect(1035500759, 10124);
        
        WaitFixedTimeFrames(22); // Requiered
        //WaitFixedTimeFrames(140); // Cooldown
        WaitFixedTimeFrames(80);
        DisableCharacterHPBarDisplay(1035500759);
        DisableCharacterCollision(1035500759);
        ForceAnimationPlayback(1035500759, 701, true, false, false);
        IssueShortWarpRequest(1035500759, TargetEntityType.Area, 1035500761, -1);
        ResetCharacterPosition(1035500759);
        DisableCharacter(1035500759);
    }
    else if (InArea(20000, 1035500751)) { // Zone 1 (Bridge)
        EnableCharacter(1035500750);
        SetSpEffect(1035500750, 10124);
        WaitFixedTimeFrames(15);
        PlaySE(10000, SoundType.SFX, 530351);
        WaitFixedTimeFrames(30);
        SpawnOneshotSFX(TargetEntityType.Character, 1035500750, 220, 510160);
        PlaySE(10000, SoundType.SFX, 303110);
        PlaySE(10000, SoundType.SFX, 500011);
        PlaySE(10000, SoundType.SFX, 523881);
        WaitFixedTimeFrames(10);
        ForceAnimationPlayback(1035500750, 3027, false, false, false);
        
        WaitFixedTimeFrames(5);
        EnableCharacterHPBarDisplay(1035500750);
        EnableCharacterCollision(1035500750);
        ClearSpEffect(1035500750, 10124);
        SetSpEffect(1035500750, 11730);
        PlaySE(10000, SoundType.SFX, 600920);
        PlaySE(10000, SoundType.SFX, 600921);
        
        WaitFixedTimeFrames(70);
        ClearSpEffect(1035500750, 11730);
        WaitFixedTimeFrames(15);
        SetSpEffect(1035500750, 10124);
        
        WaitFixedTimeFrames(22); // Requiered
        //WaitFixedTimeFrames(140); // Cooldown
        WaitFixedTimeFrames(80);
        DisableCharacterHPBarDisplay(1035500750);
        DisableCharacterCollision(1035500750);
        ForceAnimationPlayback(1035500750, 701, true, false, false);
        IssueShortWarpRequest(1035500750, TargetEntityType.Area, 1035500752, -1);
        ResetCharacterPosition(1035500750);
        DisableCharacter(1035500750);
    }
    RestartEvent();
});


// Adula Ambushes - Setup
$Event(1035508751, Restart, function(X0_4, X4_4) {
    if (EventFlag(1034500800) || EventFlag(1034420800) || (X0_4 == 1035500756 && EventFlag(1035500756))) {
        DisableCharacter(X0_4);
        DisableCharacterCollision(X0_4);
        ForceCharacterDeath(X0_4, false);
    }
    ForceAnimationPlayback(X0_4, 701, true, false, false);
    SetSpEffect(X0_4, 10124);
    
    DisableCharacterGravity(X0_4);
    DisableCharacterAI(X0_4);
    DisableCharacterHPBarDisplay(X0_4);
    DisableCharacterCollision(X0_4);
    DisableCharacter(X0_4);
    EnableCharacterFadeOnEnable(X0_4);
    
    DisableLockOnPoint(X0_4, 220);
    DisableLockOnPoint(X0_4, 224);
    DisableLockOnPoint(X0_4, 225);
    DisableLockOnPoint(X0_4, 226);
    
    EnableCharacterImmortality(X0_4);
    CreateReferredDamagePair(X0_4, X4_4);
});

// Adula Ambushes - Warning
$Event(1035508755, Restart, function() {
    EndIf(EventFlag(1035508757) || EventFlag(1034500800) || EventFlag(1034420800));
    WaitFor(InArea(10000, 1035508755));
    PlaySE(10000, SoundType.SFX, 530351);
    SetEventFlagID(1035508757, ON);
});

// Adula Ambushes - On damage disable 3
$Event(1035508756, Restart, function() {
    EndIf(EventFlag(1035508756) || EventFlag(1034500800) || EventFlag(1034420800));
    WaitFor(CharacterRatioHPRatio(1035500756) < 100);
    SetEventFlagID(1035508756, ON);
});

// Custom Puppet Appearance Logic
$Event(1035508760, Restart, function(X0_4, X4_4, X8_4, X12_4) {
    EndIf(CharacterDead(X0_4));
    if (X12_4 == 1)
        SetSpEffect(X0_4, 10124);
    EnableCharacterInvincibility(X0_4);
    DisableCharacterAI(X0_4);
    if (Signed(X4_4) > 0)
        ForceAnimationPlayback(X0_4, X4_4, true, false, true);
    WaitFor(EntityInRadiusOfEntity(10000, X0_4, 15, 1));
    if (X12_4 == 1) {
        ClearSpEffect(X0_4, 10124);
        PlaySE(X0_4, SoundType.CharacterMotion, 999997800);
        WaitFor(ElapsedFrames(22) || HasDamageType(X0_4, 10000, DamageType.Unspecified));
    }
    DisableCharacterInvincibility(X0_4);
    EnableCharacterAI(X0_4);
    if (Signed(X8_4) > 0)
        ForceAnimationPlayback(X0_4, X8_4, false, false, false);    
});

// Custom Puppet Appearance Logic
$Event(1035508770, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    EndIf(CharacterDead(X0_4));
    if (X12_4 == 1)
        SetSpEffect(X0_4, 10124);
    EnableCharacterInvincibility(X0_4);
    DisableCharacterAI(X0_4);
    if (Signed(X4_4) > 0)
        ForceAnimationPlayback(X0_4, X4_4, true, false, true);
    WaitFor(InArea(10000, X16_4));
    DisableCharacterInvincibility(X0_4);
    if (X12_4 == 1) {
        ClearSpEffect(X0_4, 10124);
        PlaySE(X0_4, SoundType.CharacterMotion, 999997800);
        WaitFor(ElapsedFrames(22) || HasDamageType(X0_4, 10000, DamageType.Unspecified));
    }
    EnableCharacterAI(X0_4);
    if (Signed(X8_4) > 0)
        ForceAnimationPlayback(X0_4, X8_4, false, false, false);    
});

// Enemies Trapped in Crystal - Flag, Enemy, Asset, [Anim], ItemLot, VFXRegion
$Event(1035508780, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4) {
    if (EventFlag(X0_4)) {
        DisableAsset(X8_4);
        DisableCharacter(X4_4);
        DisableCharacterCollision(X4_4);
        ForceCharacterDeath(X4_4, false);
        EndEvent();
    }
    DisableCharacter(X4_4);
    EnableCharacterFadeOnEnable(X4_4);
    SpawnMapSFX(X20_4);
    WaitForAssetDestroyed(DestructionState.Destroyed, X8_4, Equal, 1);
    DeleteMapSFX(X20_4, false);
    WaitFixedTimeFrames(2);
    EnableCharacter(X4_4);
    SpawnOneshotSFX(TargetEntityType.Character, X4_4, 220, 510230);
    SpawnOneshotSFX(TargetEntityType.Character, X4_4, 220, 510160);
    if (Signed(X12_4) > 0) 
        ForceAnimationPlayback(X4_4, X12_4, false, false, true);
    WaitFor(CharacterDead(X4_4));
    SetEventFlagID(X0_4, ON);
    WaitFixedTimeSeconds(2);
    AwardItemsIncludingClients(X16_4);
});

// Forced Fog
$Event(1035508790, Restart, function() {
    WaitFor(InArea(10000, 1036508500) || InArea(10000, 1036508501));
    ChangeWeather(Weather.HeavyFog, -1, false);
    WaitFixedTimeSeconds(30);
    RestartEvent();
});

//
////// OLD EVENTS BELOW ////// OLD EVENTS BELOW ////// OLD EVENTS BELOW //////
//

// Boss Defeat (Carian)
$Event(1035500800, Restart, function() {
    EndIf(EventFlag(1035500800));
    WaitFor(CharacterHPValue(1035500800) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(1035500800, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(1035500800));
    HandleBossDefeatAndDisplayBanner(1035500800, TextBannerType.EnemyFelled);
    SetEventFlagID(1035500800, ON);
    SetEventFlagID(1035505814, OFF); //music handler eventflag
    SetEventFlagID(1035505815, ON); //music handler eventflag
    SetEventFlagID(9181, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61181, ON);
    }
    WaitFixedTimeSeconds(6);
    SetEventFlagID(1035505815, OFF); //music handler eventflag
});

// Boss Activator (Carian)
$Event(1035502810, Restart, function() {
    if (EventFlag(1035500800)) {
        DisableCharacter(1035500800);
        DisableCharacterCollision(1035500800);
        ForceCharacterDeath(1035500800, false);
        EndEvent();
    }
L0:
    DisableCharacterAI(1035500800);
    EnableCharacterInvincibility(1035500800);
    DisableCharacter(1035500800);
    EnableCharacterFadeOnEnable(1035500800);
    WaitFor(
        (PlayerIsInOwnWorld() && InArea(10000, 1035502801))
            || HasDamageType(1035500800, 10000, DamageType.Unspecified));
    SetNetworkconnectedEventFlagID(1035500801, ON);
    EnableCharacter(1035500800);
    RotateCharacter(1035500800, 10000, -1, false);
    ForceAnimationPlayback(1035500800, 2000, false, false, true);
    SpawnOneshotSFX(TargetEntityType.Character, 1035500800, 960, 510160);
    SpawnOneshotSFX(TargetEntityType.Character, 1035500800, 240, 632585);
    PlaySE(1035500800, SoundType.SFX, 632650);
    SetEventFlagID(1035502806, ON);
    SetEventFlagID(1035505814, ON); //music handler eventflag
L2:
    EnableCharacterAI(1035500800);
    DisableCharacterInvincibility(1035500800);
    SetNetworkUpdateRate(1035500800, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 1035500800, 0, 904813000);
});

// Loretta Cut Content?
$Event(1035502840, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(1035500800));
    WaitFor(
        InArea(1035500800, 1035502840)
            && !EventFlag(1035502821)
            && !EventFlag(1035502822)
            && !EventFlag(1035502823)
            && !EventFlag(1035502824)
            && !EventFlag(1035502825)
            && !EventFlag(1035502826)
            && (InArea(10000, 1035502841)
                || InArea(10000, 1035502842)
                || InArea(10000, 1035502843)
                || InArea(10000, 1035502844)
                || InArea(10000, 1035502845)));
    GotoIf(L0, InArea(10000, 1035502841));
    GotoIf(L1, InArea(10000, 1035502842));
    GotoIf(L0, InArea(10000, 1035502843));
    GotoIf(L1, InArea(10000, 1035502844));
    GotoIf(L4, InArea(10000, 1035502845));
L0:
    if (EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502822, ON);
    }
    if (!EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502824, ON);
    }
    Goto(L9);
L1:
    if (EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502821, ON);
    }
    if (!EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502823, ON);
    }
    Goto(L9);
L4:
    if (EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502825, ON);
    }
    if (!EventFlag(1035502839)) {
        SetNetworkconnectedEventFlagID(1035502826, ON);
    }
    Goto(L9);
L9:
    WaitFixedTimeSeconds(1);
    RestartEvent();
});

// Loretta Cut Content?
$Event(1035502841, Restart, function() {
    EndIf(EventFlag(1035500800));
    WaitFor(
        EventFlag(1035502821)
            || EventFlag(1035502822)
            || EventFlag(1035502823)
            || EventFlag(1035502824)
            || EventFlag(1035502825)
            || EventFlag(1035502826));
    SetSpEffect(1035500800, 13806);
    DisableCharacterCollision(1035500800);
    WaitFixedTimeSeconds(1);
    GotoIf(L1, EventFlag(1035502821));
    GotoIf(L2, EventFlag(1035502822));
    GotoIf(L3, EventFlag(1035502823));
    GotoIf(L4, EventFlag(1035502824));
    GotoIf(L5, EventFlag(1035502825));
    GotoIf(L6, EventFlag(1035502826));
L1:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502821, -1);
    Goto(L9);
L2:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502822, -1);
    Goto(L9);
L3:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502823, -1);
    Goto(L9);
L4:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502824, -1);
    Goto(L9);
L5:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502825, -1);
    Goto(L9);
L6:
    IssueShortWarpRequest(1035500800, TargetEntityType.Area, 1035502826, -1);
    Goto(L9);
L9:
    EnableCharacterCollision(1035500800);
    ClearSpEffect(1035500800, 13806);
    ForceAnimationPlayback(1035500800, 20010, false, false, false);
    WaitFixedTimeSeconds(1);
    if (PlayerIsInOwnWorld()) {
        SetNetworkconnectedEventFlagID(1035502821, OFF);
        SetNetworkconnectedEventFlagID(1035502822, OFF);
        SetNetworkconnectedEventFlagID(1035502823, OFF);
        SetNetworkconnectedEventFlagID(1035502824, OFF);
        SetNetworkconnectedEventFlagID(1035502825, OFF);
        SetNetworkconnectedEventFlagID(1035502826, OFF);
    }
    RestartEvent();
});

// Loretta Cut Content?
$Event(1035502842, Restart, function() {
    EndIf(EventFlag(1035500800));
    DisableNetworkSync();
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(EventFlag(1035502810));
    SetNetworkconnectedEventFlagID(1035502839, ON);
    WaitFixedTimeSeconds(3);
    SetNetworkconnectedEventFlagID(1035502839, OFF);
    WaitFixedTimeSeconds(5);
    SetNetworkconnectedEventFlagID(1035502839, ON);
    WaitFixedTimeSeconds(4);
    SetNetworkconnectedEventFlagID(1035502839, OFF);
    WaitFixedTimeSeconds(1);
    SetNetworkconnectedEventFlagID(1035502839, ON);
    WaitFixedTimeSeconds(6);
    SetNetworkconnectedEventFlagID(1035502839, OFF);
    WaitFixedTimeSeconds(7);
    RestartEvent();
});

// Fog walls
$Event(1035502849, Restart, function() {
    InitializeCommonEvent(0, 9005800, 1035500800, 1035501800, 1035502800, 1035502805, 1035505800, 10000, 1035500801, 1035502801);
    InitializeCommonEvent(0, 9005801, 1035500800, 1035501800, 1035502800, 1035502805, 0, 10000);
    InitializeCommonEvent(0, 9005811, 1035500800, 1035501800, 3, 1035500801);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501801, 3, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501802, 3, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501803, 3, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501804, 17, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501805, 17, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501806, 17, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501807, 17, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501808, 17, 0, 3);
    InitializeCommonEvent(0, 9005813, 1035500800, 1035501809, 17, 0, 3);
    InitializeCommonEvent(0, 9005822, 1035500800, 921600, 1035502805, 6000, 1035500801, 0, 0, 0);
});

// Boss Defeat (Ainar)
$Event(1035500850, Restart, function() {
    EndIf(EventFlag(1035500850));
    WaitFor(CharacterHPValue(1035500850) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(1035500850, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(1035500850));
    HandleBossDefeatAndDisplayBanner(1035500850, TextBannerType.GreatEnemyFelled);
    SetEventFlagID(1035500850, ON);
    SetEventFlagID(1035505865, ON); //music handler eventflag
    SetEventFlagID(1035502852, OFF);
    SetEventFlagID(1035502855, OFF);
    SetEventFlagID(9189, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61189, ON);
    }
    WaitFixedTimeSeconds(6);
    SetEventFlagID(1035505865, OFF); //music handler eventflag
});

// Boss Activator (Ainar)
$Event(1035502860, Restart, function() {
    if (EventFlag(1035500850)) {
        DisableCharacter(1035500850);
        DisableCharacterCollision(1035500850);
        ForceCharacterDeath(1035500850, false);
        EndEvent();
    }
L0:
    DisableCharacterAI(1035500850);
    EnableCharacterInvincibility(1035500850);
    WaitFor((InArea(10000, 1035502850) || InArea(10000, 1035502851)) && EventFlag(1035502855));
L2:
    EnableCharacterAI(1035500850);
    DisableCharacterInvincibility(1035500850);
    SetNetworkUpdateRate(1035500850, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 1035500850, 0, 904812000);
});

//Phase Change
$Event(1035502861, Restart, function() {
    WaitFor(CharacterHasSpEffect(1035500850, 11725));
    SetEventFlagID(1035502852, ON);
    SetEventFlagID(1035502855, OFF);
    EndEvent();
});

// Fog walls
$Event(1035502899, Restart, function() {
    InitializeCommonEvent(0, 9005800, 1035500850, 1035501850, 1035502850, 1035502855, 1035505850, 10000, 0, 0);
    InitializeCommonEvent(0, 9005800, 1035500850, 1035501851, 1035502851, 1035502855, 1035505851, 10000, 0, 0);
    InitializeCommonEvent(0, 9005801, 1035500850, 1035501850, 1035502850, 1035502855, 1035502856, 10000);
    InitializeCommonEvent(0, 9005801, 1035500850, 1035501851, 1035502851, 1035502855, 1035502857, 10000);
    InitializeCommonEvent(0, 9005811, 1035500850, 1035501850, 5, 0);
    InitializeCommonEvent(0, 9005811, 1035500850, 1035501851, 3, 0);
    InitializeCommonEvent(0, 9005811, 1035500850, 1035501852, 5, 0);
    InitializeCommonEvent(0, 9005822, 1035500850, 921600, 1035502855, 1035502856, 0, 1035502852, 0, 0);
});

$Event(1035500700, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        BatchSetNetworkconnectedEventFlags(1035502700, 1035502702, OFF);
        if (EventFlag(1035509205)) {
            RandomlySetEventFlagInRange(1035502700, 1035502702, ON);
        } else {
            SetNetworkconnectedEventFlagID(1035502701, ON);
        }
        if (EventFlag(1035509202)) {
            BatchSetNetworkconnectedEventFlags(1035502700, 1035502702, OFF);
            SetNetworkconnectedEventFlagID(1035502700, ON);
        }
        if (EventFlag(1035509203)) {
            BatchSetNetworkconnectedEventFlags(1035502700, 1035502702, OFF);
            SetNetworkconnectedEventFlagID(1035502701, ON);
        }
        if (EventFlag(1035509204)) {
            BatchSetNetworkconnectedEventFlags(1035502700, 1035502702, OFF);
            SetNetworkconnectedEventFlagID(1035502702, ON);
        }
    }
L19:
    GotoIf(L5, EventFlag(3565));
    GotoIf(L6, EventFlag(3566));
    GotoIf(L7, EventFlag(3567));
    GotoIf(L8, EventFlag(3568));
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    DisableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, true);
    DisableCharacter(X8_4);
    SetCharacterBackreadState(X8_4, true);
    DisableCharacter(X12_4);
    SetCharacterBackreadState(X12_4, true);
    DisableAssetInvunerability(X16_4);
    WaitFor(AnyBatchEventFlags(3565, 3568));
    RestartEvent();
L5:
L6:
L7:
L8:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, false);
    EnableCharacter(X8_4);
    SetCharacterBackreadState(X8_4, false);
    EnableCharacter(X12_4);
    SetCharacterBackreadState(X12_4, false);
    ForceAnimationPlayback(X4_4, 930010, false, false, false);
    ForceAnimationPlayback(X8_4, 930010, false, false, false);
    ForceAnimationPlayback(X12_4, 930010, false, false, false);
    EnableAssetInvunerability(X16_4);
    RequestAssetRestoration(X16_4);
    if (EventFlag(1035502700)) {
        ForceAnimationPlayback(X0_4, 930024, false, false, false);
    }
    if (EventFlag(1035502701)) {
        ForceAnimationPlayback(X0_4, 930026, false, false, false);
    }
    if (EventFlag(1035502702)) {
        ForceAnimationPlayback(X0_4, 930028, false, false, false);
    }
    Goto(L20);
L20:
    WaitFor(!AnyBatchEventFlags(3565, 3568));
    RestartEvent();
});

$Event(1035502210, Restart, function(X0_4, X4_4, X8_4) {
    EndIf(EventFlag(X4_4));
    EndIf(AssetDestroyed(X0_4, Equal, 1));
    CreateBulletOwner(X8_4);
    chrSp = (CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
        || CharacterType(10000, TargetType.Alive)
        || CharacterType(10000, TargetType.GrayPhantom)
        || CharacterType(10000, TargetType.WhitePhantom);
    dmgArea = HasDamageType(X0_4, 20000, DamageType.Unspecified) || EntityInRadiusOfEntity(X0_4, 20000, 2, 1);
    WaitFor(dmgArea && chrSp);
    RequestAssetDestruction(X0_4, 0);
    if (EventFlag(50)) {
        ShootBullet(X8_4, X0_4, 100, 802402100, 0, 0, 0);
    }
    else if (EventFlag(51)) {
        ShootBullet(X8_4, X0_4, 100, 802402110, 0, 0, 0);
    }
    else if (EventFlag(52)) {
        ShootBullet(X8_4, X0_4, 100, 802402120, 0, 0, 0);
    }
    else if (EventFlag(53)) {
        ShootBullet(X8_4, X0_4, 100, 802402130, 0, 0, 0);
    }
    else if (EventFlag(54)) {
        ShootBullet(X8_4, X0_4, 100, 802402140, 0, 0, 0);
    }
    else if (EventFlag(55)) {
        ShootBullet(X8_4, X0_4, 100, 802402150, 0, 0, 0);
    }
    else if (EventFlag(56)) {
        ShootBullet(X8_4, X0_4, 100, 802402160, 0, 0, 0);
    }
    else if (EventFlag(57)) {
        ShootBullet(X8_4, X0_4, 100, 802402170, 0, 0, 0);
    }
    EndEvent();
});

$Event(1035500701, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
    }
L19:
    if (!EventFlag(3569)) {
        DisableCharacter(X0_4);
        SetCharacterBackreadState(X0_4, true);
        DisableCharacter(X4_4);
        SetCharacterBackreadState(X4_4, true);
        DisableCharacter(X8_4);
        SetCharacterBackreadState(X8_4, true);
        DisableCharacter(X12_4);
        DisableAsset(X16_4);
        WaitFor(EventFlag(3569));
        RestartEvent();
    }
L9:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X4_4);
    SetCharacterBackreadState(X4_4, false);
    EnableCharacter(X8_4);
    SetCharacterBackreadState(X8_4, false);
    EnableCharacter(X12_4);
    SetCharacterBackreadState(X12_4, false);
    EnableAsset(X16_4);
    ForceAnimationPlayback(X4_4, 930009, false, false, false);
    ForceAnimationPlayback(X8_4, 930009, false, false, false);
    ForceAnimationPlayback(X12_4, 930009, false, false, false);
    ForceAnimationPlayback(X0_4, 30019, false, false, false);
    SetCharacterTalkRange(X0_4, 100);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3569));
    RestartEvent();
});

$Event(1035500702, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    SetEventFlagID(1035509208, OFF);
    WaitFor(
        EventValue(67470, 8) >= 1
            && EventValue(66450, 8) >= 1
            && EventValue(130290, 8) >= 3
            && EventValue(130300, 8) >= 2
            && EventValue(130340, 8) >= 1
            && EventValue(130350, 8) >= 1
            && EventValue(130360, 8) >= 1
            && EventValue(130370, 8) >= 2
            && EventValue(130380, 8) >= 1
            && EventValue(130390, 8) >= 1
            && EventValue(69900, 8) >= 1);
    SetEventFlagID(1035509208, ON);
    EndEvent();
});

$Event(1035500703, Restart, function(X0_4, X4_4) {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(EventFlag(3569) && InArea(10000, X4_4) && PlayerIsInOwnWorld());
    SetEventFlagID(X0_4, ON);
});

$Event(1035500770, Restart, function() {
    EnableAssetInvunerability(1035500771); //light
    EnableAssetInvunerability(1035500772); //light
});
